<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Go 每日一库之 gopsutil - 大俊的博客</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="darjun" />
  <meta name="description" content="简介 gopsutil是 Python 工具库psutil 的 Golang 移植版，可以帮助我们方便地获取各种系统和硬件信息。gopsutil为我们屏蔽了各个系统之间的差" />

  <meta name="keywords" content="大俊, 大俊的博客, go, golang, gopher" />






<meta name="generator" content="Hugo 0.60.0-DEV" />


<link rel="canonical" href="https://darjun.github.io/2020/04/05/godailylib/gopsutil/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.0995afa14b62cd93e93cfc066b646c4c17a3eddca0e9d52a1d9dcf5d90aaacd3.css" integrity="sha256-CZWvoUtizZPpPPwGa2RsTBej7dyg6dUqHZ3PXZCqrNM=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/custom.css">


<meta property="og:title" content="Go 每日一库之 gopsutil" />
<meta property="og:description" content="简介 gopsutil是 Python 工具库psutil 的 Golang 移植版，可以帮助我们方便地获取各种系统和硬件信息。gopsutil为我们屏蔽了各个系统之间的差" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://darjun.github.io/2020/04/05/godailylib/gopsutil/" />
<meta property="article:published_time" content="2020-04-05T21:30:23+00:00" />
<meta property="article:modified_time" content="2020-04-05T21:30:23+00:00" />
<meta itemprop="name" content="Go 每日一库之 gopsutil">
<meta itemprop="description" content="简介 gopsutil是 Python 工具库psutil 的 Golang 移植版，可以帮助我们方便地获取各种系统和硬件信息。gopsutil为我们屏蔽了各个系统之间的差">


<meta itemprop="datePublished" content="2020-04-05T21:30:23&#43;00:00" />
<meta itemprop="dateModified" content="2020-04-05T21:30:23&#43;00:00" />
<meta itemprop="wordCount" content="4958">



<meta itemprop="keywords" content="Go 每日一库," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go 每日一库之 gopsutil"/>
<meta name="twitter:description" content="简介 gopsutil是 Python 工具库psutil 的 Golang 移植版，可以帮助我们方便地获取各种系统和硬件信息。gopsutil为我们屏蔽了各个系统之间的差"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-42862533-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">大俊</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/">首页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/about/">关于我</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/darjun" rel="noopener" target="_blank">
              Github
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      大俊
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/">首页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/about/">关于我</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/darjun" rel="noopener" target="_blank">
              Github
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Go 每日一库之 gopsutil</h1>
      
      <div class="post-meta">
        <time datetime="2020-04-05" class="post-time">
          2020-04-05
        </time>
        <div class="post-category">
            <a href="https://darjun.github.io/categories/go/"> Go </a>
            
          </div>
        <span class="more-meta"> 约 4958 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#简介">简介</a></li>
<li><a href="#快速使用">快速使用</a></li>
<li><a href="#cpu">CPU</a>
<ul>
<li><a href="#详细信息">详细信息</a></li>
<li><a href="#时间占用">时间占用</a></li>
</ul></li>
<li><a href="#磁盘">磁盘</a>
<ul>
<li><a href="#io-统计">IO 统计</a></li>
<li><a href="#分区">分区</a></li>
<li><a href="#使用率">使用率</a></li>
</ul></li>
<li><a href="#主机">主机</a>
<ul>
<li><a href="#开机时间">开机时间</a></li>
<li><a href="#内核版本和平台信息">内核版本和平台信息</a></li>
<li><a href="#终端用户">终端用户</a></li>
</ul></li>
<li><a href="#内存">内存</a></li>
<li><a href="#进程">进程</a></li>
<li><a href="#windows-服务">Windows 服务</a></li>
<li><a href="#错误和超时">错误和超时</a></li>
<li><a href="#总结">总结</a></li>
<li><a href="#参考">参考</a></li>
<li><a href="#我">我</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h2 id="简介">简介</h2>

<p><code>gopsutil</code>是 Python 工具库<a href="https://github.com/giampaolo/psutil"><code>psutil</code></a> 的 Golang 移植版，可以帮助我们方便地获取各种系统和硬件信息。<code>gopsutil</code>为我们屏蔽了各个系统之间的差异，具有非常强悍的可移植性。有了<code>gopsutil</code>，我们不再需要针对不同的系统使用<code>syscall</code>调用对应的系统方法。更棒的是<code>gopsutil</code>的实现中没有任何<code>cgo</code>的代码，使得交叉编译成为可能。</p>

<h2 id="快速使用">快速使用</h2>

<p>先安装：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="err">$</span> <span class="k">go</span> <span class="nx">get</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">shirou</span><span class="o">/</span><span class="nx">gopsutil</span></code></pre></td></tr></table>
</div>
</div>
<p>由于<code>gopsutil</code>库用到了<code>golang.org/x/sys</code>，后者在墙外，如果有类似下面的报错：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">cannot</span> <span class="nx">find</span> <span class="kn">package</span> <span class="s">&#34;golang.org/x/sys/windows&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>可使用下面的命令下载<code>golang.org/x/sys</code>在 GitHub 上的镜像：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="err">$</span> <span class="nx">git</span> <span class="nx">clone</span> <span class="nx">git</span><span class="err">@</span><span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="p">:</span><span class="nx">golang</span><span class="o">/</span><span class="nx">sys</span><span class="p">.</span><span class="nx">git</span> <span class="err">$</span><span class="nx">GOPATH</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span><span class="nx">golang</span><span class="p">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">x</span><span class="o">/</span><span class="nx">sys</span></code></pre></td></tr></table>
</div>
</div>
<p>使用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;fmt&#34;</span>

  <span class="s">&#34;github.com/shirou/gopsutil/mem&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">v</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">mem</span><span class="p">.</span><span class="nf">VirtualMemory</span><span class="p">()</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Total: %v, Available: %v, UsedPercent:%f%%\n&#34;</span><span class="p">,</span> <span class="nx">v</span><span class="p">.</span><span class="nx">Total</span><span class="p">,</span> <span class="nx">v</span><span class="p">.</span><span class="nx">Available</span><span class="p">,</span> <span class="nx">v</span><span class="p">.</span><span class="nx">UsedPercent</span><span class="p">)</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>gopsutil</code>将不同的功能划分到不同的子包中：</p>

<ul>
<li><code>cpu</code>：CPU 相关；</li>
<li><code>disk</code>：磁盘相关；</li>
<li><code>docker</code>：docker 相关；</li>
<li><code>host</code>：主机相关；</li>
<li><code>mem</code>：内存相关；</li>
<li><code>net</code>：网络相关；</li>
<li><code>process</code>：进程相关；</li>
<li><code>winservices</code>：Windows 服务相关。</li>
</ul>

<p>想要使用对应的功能，要导入对应的子包。例如，上面代码中，我们要获取内存信息，导入的是<code>mem</code>子包。<code>mem.VirtualMemory()</code>方法返回内存信息结构<code>mem.VirtualMemoryStat</code>，该结构有丰富的字段，我们最常使用的无外乎<code>Total</code>（总内存）、<code>Available</code>（可用内存）、<code>Used</code>（已使用内存）和<code>UsedPercent</code>（内存使用百分比）。<code>mem.VirtualMemoryStat</code>还实现了<code>fmt.Stringer</code>接口，以 JSON 格式返回内存信息。语句<code>fmt.Println(v)</code>会自动调用<code>v.String()</code>，将返回信息输出。程序输出：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">Total</span><span class="p">:</span> <span class="mi">8526921728</span><span class="p">,</span> <span class="nx">Available</span><span class="p">:</span> <span class="mi">3768975360</span><span class="p">,</span> <span class="nx">UsedPercent</span><span class="p">:</span><span class="mf">55.000000</span><span class="o">%</span>
<span class="p">{</span><span class="s">&#34;total&#34;</span><span class="p">:</span><span class="mi">8526921728</span><span class="p">,</span><span class="s">&#34;available&#34;</span><span class="p">:</span><span class="mi">3768975360</span><span class="p">,</span><span class="s">&#34;used&#34;</span><span class="p">:</span><span class="mi">4757946368</span><span class="p">,</span><span class="s">&#34;usedPercent&#34;</span><span class="p">:</span><span class="mi">55</span><span class="p">,</span><span class="s">&#34;free&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;active&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;inactive&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;wired&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;laundry&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;buffers&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;cached&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;writeback&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;dirty&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;writebacktmp&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;shared&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;slab&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;sreclaimable&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;sunreclaim&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;pagetables&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;swapcached&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;commitlimit&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;committedas&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;hightotal&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;highfree&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;lowtotal&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;lowfree&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;swaptotal&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;swapfree&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;mapped&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;vmalloctotal&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;vmallocused&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;vmallocchunk&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;hugepagestotal&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;hugepagesfree&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s">&#34;hugepagesize&#34;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>单位为字节，我的电脑内存 8GB，当前使用百分比为 55%，可用内存 3768975360B（即 3.51GB）。</p>

<h2 id="cpu">CPU</h2>

<p>我们知道 CPU 的核数有两种，一种是物理核数，一种是逻辑核数。物理核数就是主板上实际有多少个 CPU，一个物理 CPU 上可以有多个核心，这些核心被称为逻辑核。<code>gopsutil</code>中 CPU 相关功能在<code>cpu</code>子包中，<code>cpu</code>子包提供了获取物理和逻辑核数、CPU 使用率的接口：</p>

<ul>
<li><code>Counts(logical bool)</code>：传入<code>false</code>，返回物理核数，传入<code>true</code>，返回逻辑核数；</li>
<li><code>Percent(interval time.Duration, percpu bool)</code>：表示获取<code>interval</code>时间间隔内的 CPU 使用率，<code>percpu</code>为<code>false</code>时，获取总的 CPU 使用率，<code>percpu</code>为<code>true</code>时，分别获取每个 CPU 的使用率，返回一个<code>[]float64</code>类型的值。</li>
</ul>

<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">physicalCnt</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">cpu</span><span class="p">.</span><span class="nf">Counts</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
  <span class="nx">logicalCnt</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">cpu</span><span class="p">.</span><span class="nf">Counts</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;physical count:%d logical count:%d\n&#34;</span><span class="p">,</span> <span class="nx">physicalCnt</span><span class="p">,</span> <span class="nx">logicalCnt</span><span class="p">)</span>

  <span class="nx">totalPercent</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">cpu</span><span class="p">.</span><span class="nf">Percent</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
  <span class="nx">perPercents</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">cpu</span><span class="p">.</span><span class="nf">Percent</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;total percent:%v per percents:%v&#34;</span><span class="p">,</span> <span class="nx">totalPercent</span><span class="p">,</span> <span class="nx">perPercents</span><span class="p">)</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>上面代码获取物理核数和逻辑核数，并获取 3s 内的总 CPU 使用率和每个 CPU 各自的使用率，程序输出（注意每次运行输出可能都不相同）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">physical</span> <span class="nx">count</span><span class="p">:</span><span class="mi">4</span> <span class="nx">logical</span> <span class="nx">count</span><span class="p">:</span><span class="mi">8</span>
<span class="nx">total</span> <span class="nx">percent</span><span class="p">:[</span><span class="mf">30.729166666666668</span><span class="p">]</span> <span class="nx">per</span> <span class="nx">percents</span><span class="p">:[</span><span class="mf">32.64248704663213</span> <span class="mf">26.94300518134715</span> <span class="mf">44.559585492227974</span> <span class="mf">23.958333333333336</span> <span class="mf">36.787564766839374</span> <span class="mf">20.3125</span> <span class="mf">38.54166666666667</span> <span class="mf">28.125</span><span class="p">]</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="详细信息">详细信息</h3>

<p>调用<code>cpu.Info()</code>可获取 CPU 的详细信息，返回<code>[]cpu.InfoStat</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">infos</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">cpu</span><span class="p">.</span><span class="nf">Info</span><span class="p">()</span>
  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">info</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">infos</span> <span class="p">{</span>
    <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nf">MarshalIndent</span><span class="p">(</span><span class="nx">info</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Print</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>为了方便查看，我使用 JSON 输出结果：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="p">{</span>
 <span class="s">&#34;cpu&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s">&#34;vendorId&#34;</span><span class="p">:</span> <span class="s">&#34;GenuineIntel&#34;</span><span class="p">,</span>
 <span class="s">&#34;family&#34;</span><span class="p">:</span> <span class="s">&#34;198&#34;</span><span class="p">,</span>
 <span class="s">&#34;model&#34;</span><span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">,</span>
 <span class="s">&#34;stepping&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s">&#34;physicalId&#34;</span><span class="p">:</span> <span class="s">&#34;BFEBFBFF000906E9&#34;</span><span class="p">,</span>
 <span class="s">&#34;coreId&#34;</span><span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">,</span>
 <span class="s">&#34;cores&#34;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
 <span class="s">&#34;modelName&#34;</span><span class="p">:</span> <span class="s">&#34;Intel(R) Core(TM) i7-7700 CPU @ 3.60GHz&#34;</span><span class="p">,</span>
 <span class="s">&#34;mhz&#34;</span><span class="p">:</span> <span class="mi">3601</span><span class="p">,</span>
 <span class="s">&#34;cacheSize&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s">&#34;flags&#34;</span><span class="p">:</span> <span class="p">[],</span>
 <span class="s">&#34;microcode&#34;</span><span class="p">:</span> <span class="s">&#34;&#34;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>由结果可以看出，CPU 是 Intel 的 i7-7700 系列，频率 3.60GHz。上面是我在 Windows 上运行的返回结果，内部使用了<code>github.com/StackExchange/wmi</code>库。在 Linux 下每个逻辑 CPU 都会返回一个<code>InfoStat</code>结构。</p>

<h3 id="时间占用">时间占用</h3>

<p>调用<code>cpu.Times(percpu bool)</code>可以获取从开机算起，总 CPU 和 每个单独的 CPU 时间占用情况。传入<code>percpu=false</code>返回总的，传入<code>percpu=true</code>返回单个的。每个 CPU 时间占用情况是一个<code>TimeStat</code>结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/cpu/cpu.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">TimesStat</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">CPU</span>       <span class="kt">string</span>  <span class="s">`json:&#34;cpu&#34;`</span>
  <span class="nx">User</span>      <span class="kt">float64</span> <span class="s">`json:&#34;user&#34;`</span>
  <span class="nx">System</span>    <span class="kt">float64</span> <span class="s">`json:&#34;system&#34;`</span>
  <span class="nx">Idle</span>      <span class="kt">float64</span> <span class="s">`json:&#34;idle&#34;`</span>
  <span class="nx">Nice</span>      <span class="kt">float64</span> <span class="s">`json:&#34;nice&#34;`</span>
  <span class="nx">Iowait</span>    <span class="kt">float64</span> <span class="s">`json:&#34;iowait&#34;`</span>
  <span class="nx">Irq</span>       <span class="kt">float64</span> <span class="s">`json:&#34;irq&#34;`</span>
  <span class="nx">Softirq</span>   <span class="kt">float64</span> <span class="s">`json:&#34;softirq&#34;`</span>
  <span class="nx">Steal</span>     <span class="kt">float64</span> <span class="s">`json:&#34;steal&#34;`</span>
  <span class="nx">Guest</span>     <span class="kt">float64</span> <span class="s">`json:&#34;guest&#34;`</span>
  <span class="nx">GuestNice</span> <span class="kt">float64</span> <span class="s">`json:&#34;guestNice&#34;`</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>CPU</code>：CPU 标识，如果是总的，该字段为<code>cpu-total</code>，否则为<code>cpu0</code>、<code>cpu1</code>&hellip;；</li>
<li><code>User</code>：用户时间占用（用户态）；</li>
<li><code>System</code>：系统时间占用（内核态）；</li>
<li><code>Idle</code>：空闲时间；</li>
<li>&hellip;</li>
</ul>

<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">infos</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">cpu</span><span class="p">.</span><span class="nf">Times</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">info</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">infos</span> <span class="p">{</span>
    <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nf">MarshalIndent</span><span class="p">(</span><span class="nx">info</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Print</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>为了方便查看，我用 JSON 输出结果，下面是其中一个输出：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="p">{</span>
 <span class="s">&#34;cpu&#34;</span><span class="p">:</span> <span class="s">&#34;cpu0&#34;</span><span class="p">,</span>
 <span class="s">&#34;user&#34;</span><span class="p">:</span> <span class="mf">674.46875</span><span class="p">,</span>
 <span class="s">&#34;system&#34;</span><span class="p">:</span> <span class="mf">1184.984375</span><span class="p">,</span>
 <span class="s">&#34;idle&#34;</span><span class="p">:</span> <span class="mf">7497.1875</span><span class="p">,</span>
 <span class="s">&#34;nice&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s">&#34;iowait&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s">&#34;irq&#34;</span><span class="p">:</span> <span class="mf">75.578125</span><span class="p">,</span>
 <span class="s">&#34;softirq&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s">&#34;steal&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s">&#34;guest&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
 <span class="s">&#34;guestNice&#34;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="磁盘">磁盘</h2>

<p>子包<code>disk</code>用于获取磁盘信息。<code>disk</code>可获取 IO 统计、分区和使用率信息。下面依次介绍。</p>

<h3 id="io-统计">IO 统计</h3>

<p>调用<code>disk.IOCounters()</code>函数，返回的 IO 统计信息用<code>map[string]IOCountersStat</code>类型表示。每个分区一个结构，键为分区名，值为统计信息。这里摘取统计结构的部分字段，主要有读写的次数、字节数和时间：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/disk/disk.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">IOCountersStat</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">ReadCount</span>        <span class="kt">uint64</span> <span class="s">`json:&#34;readCount&#34;`</span>
  <span class="nx">MergedReadCount</span>  <span class="kt">uint64</span> <span class="s">`json:&#34;mergedReadCount&#34;`</span>
  <span class="nx">WriteCount</span>       <span class="kt">uint64</span> <span class="s">`json:&#34;writeCount&#34;`</span>
  <span class="nx">MergedWriteCount</span> <span class="kt">uint64</span> <span class="s">`json:&#34;mergedWriteCount&#34;`</span>
  <span class="nx">ReadBytes</span>        <span class="kt">uint64</span> <span class="s">`json:&#34;readBytes&#34;`</span>
  <span class="nx">WriteBytes</span>       <span class="kt">uint64</span> <span class="s">`json:&#34;writeBytes&#34;`</span>
  <span class="nx">ReadTime</span>         <span class="kt">uint64</span> <span class="s">`json:&#34;readTime&#34;`</span>
  <span class="nx">WriteTime</span>        <span class="kt">uint64</span> <span class="s">`json:&#34;writeTime&#34;`</span>
  <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">mapStat</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">disk</span><span class="p">.</span><span class="nf">IOCounters</span><span class="p">()</span>
  <span class="k">for</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">stat</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">mapStat</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
    <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nf">MarshalIndent</span><span class="p">(</span><span class="nx">stat</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;  &#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>输出包括所有分区，我这里只展示一个：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">C</span><span class="p">:</span>
<span class="p">{</span>
  <span class="s">&#34;readCount&#34;</span><span class="p">:</span> <span class="mi">184372</span><span class="p">,</span>
  <span class="s">&#34;mergedReadCount&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">&#34;writeCount&#34;</span><span class="p">:</span> <span class="mi">42252</span><span class="p">,</span>
  <span class="s">&#34;mergedWriteCount&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">&#34;readBytes&#34;</span><span class="p">:</span> <span class="mi">5205152768</span><span class="p">,</span>
  <span class="s">&#34;writeBytes&#34;</span><span class="p">:</span> <span class="mi">701583872</span><span class="p">,</span>
  <span class="s">&#34;readTime&#34;</span><span class="p">:</span> <span class="mi">333</span><span class="p">,</span>
  <span class="s">&#34;writeTime&#34;</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
  <span class="s">&#34;iopsInProgress&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">&#34;ioTime&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">&#34;weightedIO&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">&#34;name&#34;</span><span class="p">:</span> <span class="s">&#34;C:&#34;</span><span class="p">,</span>
  <span class="s">&#34;serialNumber&#34;</span><span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">,</span>
  <span class="s">&#34;label&#34;</span><span class="p">:</span> <span class="s">&#34;&#34;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>注意，<code>disk.IOCounters()</code>可传入可变数量的字符串参数用于标识分区，<strong>此参数在 Windows 上无效</strong>。</p>

<h3 id="分区">分区</h3>

<p>调用<code>disk.PartitionStat(all bool)</code>函数，返回分区信息。如果<code>all = false</code>，只返回实际的物理分区（包括硬盘、CD-ROM、USB），忽略其它的虚拟分区。如果<code>all = true</code>则返回所有的分区。返回类型为<code>[]PartitionStat</code>，每个分区对应一个<code>PartitionStat</code>结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/disk/
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">PartitionStat</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">Device</span>     <span class="kt">string</span> <span class="s">`json:&#34;device&#34;`</span>
  <span class="nx">Mountpoint</span> <span class="kt">string</span> <span class="s">`json:&#34;mountpoint&#34;`</span>
  <span class="nx">Fstype</span>     <span class="kt">string</span> <span class="s">`json:&#34;fstype&#34;`</span>
  <span class="nx">Opts</span>       <span class="kt">string</span> <span class="s">`json:&#34;opts&#34;`</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>Device</code>：分区标识，在 Windows 上即为<code>C:</code>这类格式；</li>
<li><code>Mountpoint</code>：挂载点，即该分区的文件路径起始位置；</li>
<li><code>Fstype</code>：文件系统类型，Windows 常用的有 FAT、NTFS 等，Linux 有 ext、ext2、ext3等；</li>
<li><code>Opts</code>：选项，与系统相关。</li>
</ul>

<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">infos</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">disk</span><span class="p">.</span><span class="nf">Partitions</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">info</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">infos</span> <span class="p">{</span>
    <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nf">MarshalIndent</span><span class="p">(</span><span class="nx">info</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;  &#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>我的 Windows 机器输出（只展示第一个分区）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="p">{</span>
  <span class="s">&#34;device&#34;</span><span class="p">:</span> <span class="s">&#34;C:&#34;</span><span class="p">,</span>
  <span class="s">&#34;mountpoint&#34;</span><span class="p">:</span> <span class="s">&#34;C:&#34;</span><span class="p">,</span>
  <span class="s">&#34;fstype&#34;</span><span class="p">:</span> <span class="s">&#34;NTFS&#34;</span><span class="p">,</span>
  <span class="s">&#34;opts&#34;</span><span class="p">:</span> <span class="s">&#34;rw.compress&#34;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>由上面的输出可知，我的第一个分区为<code>C:</code>，文件系统类型为<code>NTFS</code>。</p>

<h3 id="使用率">使用率</h3>

<p>调用<code>disk.Usage(path string)</code>即可获得路径<code>path</code>所在磁盘的使用情况，返回一个<code>UsageStat</code>结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/disk.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">UsageStat</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">Path</span>              <span class="kt">string</span>  <span class="s">`json:&#34;path&#34;`</span>
  <span class="nx">Fstype</span>            <span class="kt">string</span>  <span class="s">`json:&#34;fstype&#34;`</span>
  <span class="nx">Total</span>             <span class="kt">uint64</span>  <span class="s">`json:&#34;total&#34;`</span>
  <span class="nx">Free</span>              <span class="kt">uint64</span>  <span class="s">`json:&#34;free&#34;`</span>
  <span class="nx">Used</span>              <span class="kt">uint64</span>  <span class="s">`json:&#34;used&#34;`</span>
  <span class="nx">UsedPercent</span>       <span class="kt">float64</span> <span class="s">`json:&#34;usedPercent&#34;`</span>
  <span class="nx">InodesTotal</span>       <span class="kt">uint64</span>  <span class="s">`json:&#34;inodesTotal&#34;`</span>
  <span class="nx">InodesUsed</span>        <span class="kt">uint64</span>  <span class="s">`json:&#34;inodesUsed&#34;`</span>
  <span class="nx">InodesFree</span>        <span class="kt">uint64</span>  <span class="s">`json:&#34;inodesFree&#34;`</span>
  <span class="nx">InodesUsedPercent</span> <span class="kt">float64</span> <span class="s">`json:&#34;inodesUsedPercent&#34;`</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>Path</code>：路径，传入的参数；</li>
<li><code>Fstype</code>：文件系统类型；</li>
<li><code>Total</code>：该分区总容量；</li>
<li><code>Free</code>：空闲容量；</li>
<li><code>Used</code>：已使用的容量；</li>
<li><code>UsedPercent</code>：使用百分比。</li>
</ul>

<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">info</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">disk</span><span class="p">.</span><span class="nf">Usage</span><span class="p">(</span><span class="s">&#34;D:/code/golang&#34;</span><span class="p">)</span>
  <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nf">MarshalIndent</span><span class="p">(</span><span class="nx">info</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;  &#34;</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>由于返回的是磁盘的使用情况，所以路径<code>D:/code/golang</code>和<code>D:</code>返回同样的结果，只是结构中的<code>Path</code>字段不同而已。程序输出：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="p">{</span>
  <span class="s">&#34;path&#34;</span><span class="p">:</span> <span class="s">&#34;D:/code/golang&#34;</span><span class="p">,</span>
  <span class="s">&#34;fstype&#34;</span><span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">,</span>
  <span class="s">&#34;total&#34;</span><span class="p">:</span> <span class="mi">475779821568</span><span class="p">,</span>
  <span class="s">&#34;free&#34;</span><span class="p">:</span> <span class="mi">385225650176</span><span class="p">,</span>
  <span class="s">&#34;used&#34;</span><span class="p">:</span> <span class="mi">90554171392</span><span class="p">,</span>
  <span class="s">&#34;usedPercent&#34;</span><span class="p">:</span> <span class="mf">19.032789388496106</span><span class="p">,</span>
  <span class="s">&#34;inodesTotal&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">&#34;inodesUsed&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">&#34;inodesFree&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s">&#34;inodesUsedPercent&#34;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="主机">主机</h2>

<p>子包<code>host</code>可以获取主机相关信息，如开机时间、内核版本号、平台信息等等。</p>

<h3 id="开机时间">开机时间</h3>

<p><code>host.BootTime()</code>返回主机开机时间的时间戳：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">timestamp</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">host</span><span class="p">.</span><span class="nf">BootTime</span><span class="p">()</span>
  <span class="nx">t</span> <span class="o">:=</span> <span class="nx">time</span><span class="p">.</span><span class="nf">Unix</span><span class="p">(</span><span class="nb">int64</span><span class="p">(</span><span class="nx">timestamp</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nf">Local</span><span class="p">().</span><span class="nf">Format</span><span class="p">(</span><span class="s">&#34;2006-01-02 15:04:05&#34;</span><span class="p">))</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>上面先获取开机时间，然后通过<code>time.Unix()</code>将其转为<code>time.Time</code>类型，最后输出<code>2006-01-02 15:04:05</code>格式的时间：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="mi">2020</span><span class="o">-</span><span class="mo">04</span><span class="o">-</span><span class="mo">06</span> <span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">32</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="内核版本和平台信息">内核版本和平台信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">version</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">host</span><span class="p">.</span><span class="nf">KernelVersion</span><span class="p">()</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">version</span><span class="p">)</span>

  <span class="nx">platform</span><span class="p">,</span> <span class="nx">family</span><span class="p">,</span> <span class="nx">version</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">host</span><span class="p">.</span><span class="nf">PlatformInformation</span><span class="p">()</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;platform:&#34;</span><span class="p">,</span> <span class="nx">platform</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;family:&#34;</span><span class="p">,</span> <span class="nx">family</span><span class="p">,</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;version:&#34;</span><span class="p">,</span> <span class="nx">version</span><span class="p">)</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>在我的 Win10 上运行输出：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="mf">10.0.18362</span> <span class="nx">Build</span> <span class="mi">18362</span>
<span class="nx">platform</span><span class="p">:</span> <span class="nx">Microsoft</span> <span class="nx">Windows</span> <span class="mi">10</span> <span class="nx">Pro</span>
<span class="nx">family</span><span class="p">:</span> <span class="nx">Standalone</span> <span class="nx">Workstation</span>
<span class="nx">version</span><span class="p">:</span> <span class="mf">10.0.18362</span> <span class="nx">Build</span> <span class="mi">18362</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="终端用户">终端用户</h3>

<p><code>host.Users()</code>返回终端连接上来的用户信息，每个用户一个<code>UserStat</code>结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/host/host.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">UserStat</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">User</span>     <span class="kt">string</span> <span class="s">`json:&#34;user&#34;`</span>
  <span class="nx">Terminal</span> <span class="kt">string</span> <span class="s">`json:&#34;terminal&#34;`</span>
  <span class="nx">Host</span>     <span class="kt">string</span> <span class="s">`json:&#34;host&#34;`</span>
  <span class="nx">Started</span>  <span class="kt">int</span>    <span class="s">`json:&#34;started&#34;`</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>字段一目了然，看示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">users</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">host</span><span class="p">.</span><span class="nf">Users</span><span class="p">()</span>
  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">user</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">users</span> <span class="p">{</span>
    <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nf">MarshalIndent</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="内存">内存</h2>

<p>在<a href="#快速开始">快速开始</a>中，我们演示了如何使用<code>mem.VirtualMemory()</code>来获取内存信息。该函数返回的只是物理内存信息。我们还可以使用<code>mem.SwapMemory()</code>获取交换内存的信息，信息存储在结构<code>SwapMemoryStat</code>中：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/mem/
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">SwapMemoryStat</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">Total</span>       <span class="kt">uint64</span>  <span class="s">`json:&#34;total&#34;`</span>
  <span class="nx">Used</span>        <span class="kt">uint64</span>  <span class="s">`json:&#34;used&#34;`</span>
  <span class="nx">Free</span>        <span class="kt">uint64</span>  <span class="s">`json:&#34;free&#34;`</span>
  <span class="nx">UsedPercent</span> <span class="kt">float64</span> <span class="s">`json:&#34;usedPercent&#34;`</span>
  <span class="nx">Sin</span>         <span class="kt">uint64</span>  <span class="s">`json:&#34;sin&#34;`</span>
  <span class="nx">Sout</span>        <span class="kt">uint64</span>  <span class="s">`json:&#34;sout&#34;`</span>
  <span class="nx">PgIn</span>        <span class="kt">uint64</span>  <span class="s">`json:&#34;pgin&#34;`</span>
  <span class="nx">PgOut</span>       <span class="kt">uint64</span>  <span class="s">`json:&#34;pgout&#34;`</span>
  <span class="nx">PgFault</span>     <span class="kt">uint64</span>  <span class="s">`json:&#34;pgfault&#34;`</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>字段含义很容易理解，<code>PgIn/PgOut/PgFault</code>这三个字段我们重点介绍一下。交换内存是以<strong>页</strong>为单位的，如果出现缺页错误(<code>page fault</code>)，操作系统会将磁盘中的某些页载入内存，同时会根据特定的机制淘汰一些内存中的页。<code>PgIn</code>表征载入页数，<code>PgOut</code>淘汰页数，<code>PgFault</code>缺页错误数。</p>

<p>例如：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">swapMemory</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">mem</span><span class="p">.</span><span class="nf">SwapMemory</span><span class="p">()</span>
  <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nf">MarshalIndent</span><span class="p">(</span><span class="nx">swapMemory</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="进程">进程</h2>

<p><code>process</code>可用于获取系统当前运行的进程信息，创建新进程，对进程进行一些操作等。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">rootProcess</span> <span class="o">*</span><span class="nx">process</span><span class="p">.</span><span class="nx">Process</span>
  <span class="nx">processes</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">process</span><span class="p">.</span><span class="nf">Processes</span><span class="p">()</span>
  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">p</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">processes</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">p</span><span class="p">.</span><span class="nx">Pid</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
      <span class="nx">rootProcess</span> <span class="p">=</span> <span class="nx">p</span>
      <span class="k">break</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">rootProcess</span><span class="p">)</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;children:&#34;</span><span class="p">)</span>
  <span class="nx">children</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">rootProcess</span><span class="p">.</span><span class="nf">Children</span><span class="p">()</span>
  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">p</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">children</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>先调用<code>process.Processes()</code>获取当前系统中运行的所有进程，然后找到<code>Pid</code>为 0 的进程，即操作系统的第一个进程，最后调用<code>Children()</code>返回其子进程。还有很多方法可获取进程信息，感兴趣可查看文档了解~</p>

<h2 id="windows-服务">Windows 服务</h2>

<p><code>winservices</code>子包可以获取 Windows 系统中的服务信息，内部使用了<code>golang.org/x/sys</code>包。在<code>winservices</code>中，一个服务对应一个<code>Service</code>结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/winservices/winservices.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Service</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">Name</span>   <span class="kt">string</span>
  <span class="nx">Config</span> <span class="nx">mgr</span><span class="p">.</span><span class="nx">Config</span>
  <span class="nx">Status</span> <span class="nx">ServiceStatus</span>
  <span class="c1">// contains filtered or unexported fields
</span><span class="c1"></span><span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>mgr.Config</code>为包<code>golang.org/x/sys</code>中的结构，该结构详细记录了服务类型、启动类型（自动/手动）、二进制文件路径等信息：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/golang.org/x/sys/windows/svc/mgr/config.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Config</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">ServiceType</span>      <span class="kt">uint32</span>
  <span class="nx">StartType</span>        <span class="kt">uint32</span>
  <span class="nx">ErrorControl</span>     <span class="kt">uint32</span>
  <span class="nx">BinaryPathName</span>   <span class="kt">string</span>
  <span class="nx">LoadOrderGroup</span>   <span class="kt">string</span>
  <span class="nx">TagId</span>            <span class="kt">uint32</span>
  <span class="nx">Dependencies</span>     <span class="p">[]</span><span class="kt">string</span>
  <span class="nx">ServiceStartName</span> <span class="kt">string</span>
  <span class="nx">DisplayName</span>      <span class="kt">string</span>
  <span class="nx">Password</span>         <span class="kt">string</span>
  <span class="nx">Description</span>      <span class="kt">string</span>
  <span class="nx">SidType</span>          <span class="kt">uint32</span>
  <span class="nx">DelayedAutoStart</span> <span class="kt">bool</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>ServiceStatus</code>结构记录了服务的状态：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/winservices/winservices.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">ServiceStatus</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">State</span>         <span class="nx">svc</span><span class="p">.</span><span class="nx">State</span>
  <span class="nx">Accepts</span>       <span class="nx">svc</span><span class="p">.</span><span class="nx">Accepted</span>
  <span class="nx">Pid</span>           <span class="kt">uint32</span>
  <span class="nx">Win32ExitCode</span> <span class="kt">uint32</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>State</code>：为服务状态，有已停止、运行、暂停等；</li>
<li><code>Accepts</code>：表示服务接收哪些操作，有暂停、继续、会话切换等；</li>
<li><code>Pid</code>：进程 ID；</li>
<li><code>Win32ExitCode</code>：应用程序退出状态码。</li>
</ul>

<p>下面程序中，我将系统中所有服务的名称、二进制文件路径和状态输出到控制台：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">services</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">winservices</span><span class="p">.</span><span class="nf">ListServices</span><span class="p">()</span>

  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">service</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">services</span> <span class="p">{</span>
    <span class="nx">newservice</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">winservices</span><span class="p">.</span><span class="nf">NewService</span><span class="p">(</span><span class="nx">service</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>
    <span class="nx">newservice</span><span class="p">.</span><span class="nf">GetServiceDetail</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Name:&#34;</span><span class="p">,</span> <span class="nx">newservice</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span> <span class="s">&#34;Binary Path:&#34;</span><span class="p">,</span> <span class="nx">newservice</span><span class="p">.</span><span class="nx">Config</span><span class="p">.</span><span class="nx">BinaryPathName</span><span class="p">,</span> <span class="s">&#34;State: &#34;</span><span class="p">,</span> <span class="nx">newservice</span><span class="p">.</span><span class="nx">Status</span><span class="p">.</span><span class="nx">State</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>注意，调用<code>winservices.ListServices()</code>返回的<code>Service</code>对象信息是不全的，我们通过<code>NewService()</code>以该服务名称创建一个服务，然后调用<code>GetServiceDetail()</code>方法获取该服务的详细信息。不能直接通过<code>service.GetServiceDetail()</code>来调用，因为<code>ListService()</code>返回的对象缺少必要的系统资源句柄（为了节约资源），调用<code>GetServiceDetail()</code>方法会<code>panic</code>！！！</p>

<h2 id="错误和超时">错误和超时</h2>

<p>由于大部分函数都涉及到底层的系统调用，所以发生错误和超时是在所难免的。几乎所有的接口都有两个返回值，第二个作为错误。在前面的例子中，我们为了简化代码都忽略了错误，在实际使用中，建议对错误进行处理。</p>

<p>另外，大部分接口都是一对，一个不带<code>context.Context</code>类型的参数，另一个带有该类型参数，用于做上下文控制。在内部调用发生错误或超时后能及时处理，避免长时间等待返回。实际上，不带<code>context.Context</code>参数的函数内部都是以<code>context.Background()</code>为参数调用带有<code>context.Context</code>的函数的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/github.com/shirou/gopsutil/cpu_windows.go
</span><span class="c1"></span><span class="kd">func</span> <span class="nf">Times</span><span class="p">(</span><span class="nx">percpu</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">([]</span><span class="nx">TimesStat</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nf">TimesWithContext</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nf">Background</span><span class="p">(),</span> <span class="nx">percpu</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">TimesWithContext</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">percpu</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">([]</span><span class="nx">TimesStat</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="总结">总结</h2>

<p><code>gopsutil</code>库方便了我们获取本机的信息，且很好地处理了各个系统间的兼容问题，提供了一致的接口。还有几个子包例如<code>net/docker</code>限于篇幅没有介绍，感兴趣的童鞋可自行探索。</p>

<p>大家如果发现好玩、好用的 Go 语言库，欢迎到 Go 每日一库 GitHub 上提交 issue😄</p>

<h2 id="参考">参考</h2>

<ol>
<li>gopsutil GitHub：<a href="https://github.com/shirou/gopsutil">https://github.com/shirou/gopsutil</a></li>
<li>Go 每日一库 GitHub：<a href="https://github.com/darjun/go-daily-lib">https://github.com/darjun/go-daily-lib</a></li>
</ol>

<h2 id="我">我</h2>

<p>我的博客：<a href="https://darjun.github.io">https://darjun.github.io</a></p>

<p>欢迎关注我的微信公众号【GoUpUp】，共同学习，一起进步~</p>

<p><img src="/img/wxgzh8.jpg#center" alt="" /></p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">darjun</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2020-04-05
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/2020/04/07/godailylib/gentleman/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Go 每日一库之 gentleman</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/2020/04/04/godailylib/validator/">
            <span class="next-text nav-default">Go 每日一库之 validator</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "darjun/blog-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  <div class="disqus-comment">
  <div class="disqus-button" id="load_disqus" onclick="load_disqus()">
    显示 Disqus 评论
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = "https://darjun.github.io/2020/04/05/godailylib/gopsutil/";
    };
    function load_disqus() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'https-maiyang-me';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

      $('#load_disqus').remove();
    };
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  
  </div>

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:leedarjun@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/darjun" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://darjun.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2018 -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        大俊
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.dee43230127a73d039a734510fa896c89c3c7ce0cf0be0c7a7433f8fd69b76dc.js" integrity="sha256-3uQyMBJ6c9A5pzRRD6iWyJw8fODPC&#43;DHp0M/j9abdtw=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>












</body>
</html>
