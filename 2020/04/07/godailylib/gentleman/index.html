<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Go 每日一库之 gentleman - 大俊的博客</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="darjun" />
  <meta name="description" content="简介 gentleman是一个功能齐全、插件驱动的 HTTP 客户端。gentleman以扩展性为原则，可以基于内置的或第三方插件创建具有丰富特性的、可" />

  <meta name="keywords" content="大俊, 大俊的博客, go, golang, gopher" />






<meta name="generator" content="Hugo 0.60.0-DEV" />


<link rel="canonical" href="https://darjun.github.io/2020/04/07/godailylib/gentleman/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.fa3d941d1d0e0ddc985804227feabffea55c89883eb0af34e0532a7ae9135151.css" integrity="sha256-&#43;j2UHR0ODdyYWAQif&#43;q//qVciYg&#43;sK804FMqeukTUVE=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/custom.css">


<meta property="og:title" content="Go 每日一库之 gentleman" />
<meta property="og:description" content="简介 gentleman是一个功能齐全、插件驱动的 HTTP 客户端。gentleman以扩展性为原则，可以基于内置的或第三方插件创建具有丰富特性的、可" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://darjun.github.io/2020/04/07/godailylib/gentleman/" />
<meta property="article:published_time" content="2020-04-07T21:30:23+00:00" />
<meta property="article:modified_time" content="2020-04-07T21:30:23+00:00" />
<meta itemprop="name" content="Go 每日一库之 gentleman">
<meta itemprop="description" content="简介 gentleman是一个功能齐全、插件驱动的 HTTP 客户端。gentleman以扩展性为原则，可以基于内置的或第三方插件创建具有丰富特性的、可">


<meta itemprop="datePublished" content="2020-04-07T21:30:23&#43;00:00" />
<meta itemprop="dateModified" content="2020-04-07T21:30:23&#43;00:00" />
<meta itemprop="wordCount" content="3822">



<meta itemprop="keywords" content="Go 每日一库," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go 每日一库之 gentleman"/>
<meta name="twitter:description" content="简介 gentleman是一个功能齐全、插件驱动的 HTTP 客户端。gentleman以扩展性为原则，可以基于内置的或第三方插件创建具有丰富特性的、可"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-42862533-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">大俊</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/">首页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/about/">关于我</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/darjun" rel="noopener" target="_blank">
              Github
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      大俊
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/">首页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/about/">关于我</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/darjun" rel="noopener" target="_blank">
              Github
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Go 每日一库之 gentleman</h1>
      
      <div class="post-meta">
        <time datetime="2020-04-07" class="post-time">
          2020-04-07
        </time>
        <div class="post-category">
            <a href="https://darjun.github.io/categories/go/"> Go </a>
            
          </div>
        <span class="more-meta"> 约 3822 字 </span>
          <span class="more-meta"> 预计阅读 8 分钟 </span>

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#简介">简介</a></li>
<li><a href="#快速使用">快速使用</a></li>
<li><a href="#插件">插件</a>
<ul>
<li><a href="#body"><code>body</code></a></li>
<li><a href="#header"><code>header</code></a></li>
<li><a href="#query"><code>query</code></a></li>
<li><a href="#url"><code>url</code></a></li>
<li><a href="#其他">其他</a></li>
<li><a href="#自定义">自定义</a></li>
</ul></li>
<li><a href="#总结">总结</a></li>
<li><a href="#参考">参考</a></li>
<li><a href="#我">我</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h2 id="简介">简介</h2>

<p><a href="https://github.com/h2non/gentleman"><code>gentleman</code></a>是一个功能齐全、<strong>插件</strong>驱动的 HTTP 客户端。<code>gentleman</code>以扩展性为原则，可以基于内置的或第三方插件创建具有丰富特性的、可复用的 HTTP 客户端。相比标准库<code>net/http</code>，<code>gentleman</code>更灵活、易用。</p>

<h2 id="快速使用">快速使用</h2>

<p>先安装：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="err">$</span> <span class="k">go</span> <span class="nx">get</span> <span class="nx">gopkg</span><span class="p">.</span><span class="nx">in</span><span class="o">/</span><span class="nx">h2non</span><span class="o">/</span><span class="nx">gentleman</span><span class="p">.</span><span class="nx">v2</span></code></pre></td></tr></table>
</div>
</div>
<p>后使用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;fmt&#34;</span>

  <span class="s">&#34;gopkg.in/h2non/gentleman.v2&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">cli</span> <span class="o">:=</span> <span class="nx">gentleman</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>

  <span class="nx">cli</span><span class="p">.</span><span class="nf">URL</span><span class="p">(</span><span class="s">&#34;https://dog.ceo&#34;</span><span class="p">)</span>

  <span class="nx">req</span> <span class="o">:=</span> <span class="nx">cli</span><span class="p">.</span><span class="nf">Request</span><span class="p">()</span>

  <span class="nx">req</span><span class="p">.</span><span class="nf">Path</span><span class="p">(</span><span class="s">&#34;/api/breeds/image/random&#34;</span><span class="p">)</span>

  <span class="nx">req</span><span class="p">.</span><span class="nf">SetHeader</span><span class="p">(</span><span class="s">&#34;Client&#34;</span><span class="p">,</span> <span class="s">&#34;gentleman&#34;</span><span class="p">)</span>

  <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Send</span><span class="p">()</span>

  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Request error: %vn&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">!</span><span class="nx">res</span><span class="p">.</span><span class="nx">Ok</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Invalid server response: %dn&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Body: %s&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>gentleman</code>目前有两个版本<code>v1</code>和<code>v2</code>，<code>v2</code>已经稳定，推荐使用，示例中使用的就是<code>v2</code>。<code>gentleman</code>的使用遵循下面的流程：</p>

<ul>
<li>调用<code>gentleman.New()</code>创建一个 HTTP 客户端<code>cli</code>，<strong>此<code>cli</code>对象可复用</strong>；</li>
<li>调用<code>cli.URL()</code>设置要请求的 URL 基础地址；</li>
<li>调用<code>cli.Request()</code>创建一个请求对象<code>req</code>；</li>
<li>调用<code>req.Path()</code>设置请求的路径，基于前面设置的 URL；</li>
<li>调用<code>req.Header()</code>设置请求首部（<code>Header</code>），上面代码设置首部<code>Client</code>为<code>gentleman</code>；</li>
<li>调用<code>req.Send()</code>发送请求，获取响应对象<code>res</code>；</li>
<li>对响应对象<code>res</code>进行处理。</li>
</ul>

<p>上面的测试 API 是我从<a href="https://github.com/public-apis/public-apis">public-apis</a>找的。<code>public-apis</code>是 GitHub 上一个收集各种开放 API 的仓库。本文后面部分的 API 也来自于这个仓库。从<code>https://dog.ceo</code>我们可以获取各种和<strong>狗</strong>相关的信息，上面请求的路径<code>/api/breeds/image/random</code>将返回一个随机品种的狗的图片。运行结果：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">Body</span><span class="p">:</span> <span class="p">{</span><span class="s">&#34;message&#34;</span><span class="p">:</span><span class="s">&#34;https://images.dog.ceo/breeds/malamute/n02110063_10567.jpg&#34;</span><span class="p">,</span><span class="s">&#34;status&#34;</span><span class="p">:</span><span class="s">&#34;success&#34;</span><span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>由于是随机的，每次运行结果可能都不相同，<code>status</code>为<code>success</code>表示运行成功，<code>message</code>对应的值为图片的 URL。感兴趣自己在浏览器中打开返回的 URL，我获取的图片如下：</p>

<p><img src="/img/in-post/godailylib/gentleman1.jpg#center" alt="" /></p>

<h2 id="插件">插件</h2>

<p><code>gentleman</code>中的特性很多都是通过<strong>插件</strong>来实现的。<code>gentleman</code>内置了很多常用的插件。如果要实现的特性无法通过内置插件来完成，还有第三方插件可供选择，当然还可以自定义插件！<code>gentleman</code>的插件都是存放在<code>plugins</code>子目录中的，下面介绍几个常用的插件。</p>

<h3 id="body"><code>body</code></h3>

<p>客户端有时需要发送 JSON、XML 等格式的数据，<code>body</code>插件可以很好地完成这个任务：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;fmt&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2/plugins/body&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">cli</span> <span class="o">:=</span> <span class="nx">gentleman</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">URL</span><span class="p">(</span><span class="s">&#34;http://httpbin.org/post&#34;</span><span class="p">)</span>

  <span class="nx">data</span> <span class="o">:=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span><span class="s">&#34;foo&#34;</span><span class="p">:</span> <span class="s">&#34;bar&#34;</span><span class="p">}</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nf">JSON</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>

  <span class="nx">req</span> <span class="o">:=</span> <span class="nx">cli</span><span class="p">.</span><span class="nf">Request</span><span class="p">()</span>
  <span class="nx">req</span><span class="p">.</span><span class="nf">Method</span><span class="p">(</span><span class="s">&#34;POST&#34;</span><span class="p">)</span>

  <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Send</span><span class="p">()</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Request error: %s\n&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">!</span><span class="nx">res</span><span class="p">.</span><span class="nx">Ok</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Invalid server response: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Status: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Body: %s&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>注意插件的导入方式：<code>import &quot;gopkg.in/h2non/gentleman.v2/plugins/body&quot;</code>。</p>

<p>调用客户端对象<code>cli</code>或请求对象<code>req</code>的<code>Use()</code>方法使用插件。区别在于<code>cli.Use()</code>调用之后，所有通过该<code>cli</code>创建的请求对象都使用该插件，<code>req.Use()</code>只对该请求生效，在本例中使用<code>req.Use(body.JSON(data))</code>也是可以的。上面使用<code>body.JSON()</code>插件，每次发送请求时，都将<code>data</code>转为 JSON 设置到请求体中，并设置相应的首部（<code>Content-Type/Content-Length</code>）。<code>req.Method(&quot;POST&quot;)</code>设置使用 POST 方法。本次请求使用的 URL <code>http://httpbin.org/post</code>会回显请求的信息，看运行结果：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">Status</span><span class="p">:</span> <span class="mi">200</span>
<span class="nx">Body</span><span class="p">:</span> <span class="p">{</span>
  <span class="s">&#34;args&#34;</span><span class="p">:</span> <span class="p">{},</span> 
  <span class="s">&#34;data&#34;</span><span class="p">:</span> <span class="s">&#34;{\&#34;foo\&#34;:\&#34;bar\&#34;}\n&#34;</span><span class="p">,</span> 
  <span class="s">&#34;files&#34;</span><span class="p">:</span> <span class="p">{},</span> 
  <span class="s">&#34;form&#34;</span><span class="p">:</span> <span class="p">{},</span> 
  <span class="s">&#34;headers&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">&#34;Accept-Encoding&#34;</span><span class="p">:</span> <span class="s">&#34;gzip&#34;</span><span class="p">,</span> 
    <span class="s">&#34;Content-Length&#34;</span><span class="p">:</span> <span class="s">&#34;14&#34;</span><span class="p">,</span> 
    <span class="s">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="s">&#34;application/json&#34;</span><span class="p">,</span> 
    <span class="s">&#34;Host&#34;</span><span class="p">:</span> <span class="s">&#34;httpbin.org&#34;</span><span class="p">,</span> 
    <span class="s">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s">&#34;gentleman/2.0.4&#34;</span><span class="p">,</span> 
    <span class="s">&#34;X-Amzn-Trace-Id&#34;</span><span class="p">:</span> <span class="s">&#34;Root=1-5e8dd0c7-ab423c10fb530deade846500&#34;</span>
  <span class="p">},</span> 
  <span class="s">&#34;json&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">&#34;foo&#34;</span><span class="p">:</span> <span class="s">&#34;bar&#34;</span>
  <span class="p">},</span> 
  <span class="s">&#34;origin&#34;</span><span class="p">:</span> <span class="s">&#34;124.77.254.163&#34;</span><span class="p">,</span> 
  <span class="s">&#34;url&#34;</span><span class="p">:</span> <span class="s">&#34;http://httpbin.org/post&#34;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>发送 XML 格式与上面的非常类似：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">User</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">Name</span> <span class="kt">string</span> <span class="s">`xml:&#34;name&#34;`</span>
  <span class="nx">Age</span>  <span class="kt">int</span>    <span class="s">`xml:&#34;age&#34;`</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">cli</span> <span class="o">:=</span> <span class="nx">gentleman</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">URL</span><span class="p">(</span><span class="s">&#34;http://httpbin.org/post&#34;</span><span class="p">)</span>

  <span class="nx">req</span> <span class="o">:=</span> <span class="nx">cli</span><span class="p">.</span><span class="nf">Request</span><span class="p">()</span>
  <span class="nx">req</span><span class="p">.</span><span class="nf">Method</span><span class="p">(</span><span class="s">&#34;POST&#34;</span><span class="p">)</span>

  <span class="nx">u</span> <span class="o">:=</span> <span class="nx">User</span><span class="p">{</span><span class="nx">Name</span><span class="p">:</span> <span class="s">&#34;dj&#34;</span><span class="p">,</span> <span class="nx">Age</span><span class="p">:</span> <span class="mi">18</span><span class="p">}</span>
  <span class="nx">req</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">body</span><span class="p">.</span><span class="nf">XML</span><span class="p">(</span><span class="nx">u</span><span class="p">))</span>
  <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>后半部分一样的代码我就省略了，运行结果：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">Status</span><span class="p">:</span> <span class="mi">200</span>
<span class="nx">Body</span><span class="p">:</span> <span class="p">{</span>
  <span class="s">&#34;args&#34;</span><span class="p">:</span> <span class="p">{},</span> 
  <span class="s">&#34;data&#34;</span><span class="p">:</span> <span class="s">&#34;&lt;User&gt;&lt;name&gt;dj&lt;/name&gt;&lt;age&gt;18&lt;/age&gt;&lt;/User&gt;&#34;</span><span class="p">,</span> 
  <span class="s">&#34;files&#34;</span><span class="p">:</span> <span class="p">{},</span> 
  <span class="s">&#34;form&#34;</span><span class="p">:</span> <span class="p">{},</span> 
  <span class="s">&#34;headers&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">&#34;Accept-Encoding&#34;</span><span class="p">:</span> <span class="s">&#34;gzip&#34;</span><span class="p">,</span> 
    <span class="s">&#34;Content-Length&#34;</span><span class="p">:</span> <span class="s">&#34;41&#34;</span><span class="p">,</span> 
    <span class="s">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="s">&#34;application/xml&#34;</span><span class="p">,</span> 
    <span class="s">&#34;Host&#34;</span><span class="p">:</span> <span class="s">&#34;httpbin.org&#34;</span><span class="p">,</span> 
    <span class="s">&#34;User-Agent&#34;</span><span class="p">:</span> <span class="s">&#34;gentleman/2.0.4&#34;</span><span class="p">,</span> 
    <span class="s">&#34;X-Amzn-Trace-Id&#34;</span><span class="p">:</span> <span class="s">&#34;Root=1-5e8dd339-830dba04536ceef247156746&#34;</span>
  <span class="p">},</span> 
  <span class="s">&#34;json&#34;</span><span class="p">:</span> <span class="nx">null</span><span class="p">,</span> 
  <span class="s">&#34;origin&#34;</span><span class="p">:</span> <span class="s">&#34;222.64.16.70&#34;</span><span class="p">,</span> 
  <span class="s">&#34;url&#34;</span><span class="p">:</span> <span class="s">&#34;http://httpbin.org/post&#34;</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="header"><code>header</code></h3>

<p><code>header</code>插件用于在发送请求前添加一些通用的首部，如 APIKey；或者删除一些自动加上的首部，如<code>User-Agent</code>。一般<code>header</code>插件应用在<code>cli</code>对象上：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;fmt&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2/plugins/headers&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">cli</span> <span class="o">:=</span> <span class="nx">gentleman</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">URL</span><span class="p">(</span><span class="s">&#34;https://api.thecatapi.com&#34;</span><span class="p">)</span>

  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">headers</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;x-api-key&#34;</span><span class="p">,</span> <span class="s">&#34;479ce48d-db30-46a4-b1a0-91ac4c1477b8&#34;</span><span class="p">))</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">headers</span><span class="p">.</span><span class="nf">Del</span><span class="p">(</span><span class="s">&#34;User-Agent&#34;</span><span class="p">))</span>

  <span class="nx">req</span> <span class="o">:=</span> <span class="nx">cli</span><span class="p">.</span><span class="nf">Request</span><span class="p">()</span>
  <span class="nx">req</span><span class="p">.</span><span class="nf">Path</span><span class="p">(</span><span class="s">&#34;/v1/breeds&#34;</span><span class="p">)</span>
  <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Send</span><span class="p">()</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Request error: %s\n&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">!</span><span class="nx">res</span><span class="p">.</span><span class="nx">Ok</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Invalid server response: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Status: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Body: %s&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>上面我们使用了<code>https://api.thecatapi.com</code>，这个 API 可以获取<strong>猫</strong>的品种信息，支持返回全部品种，搜索，分页等操作。API 使用需要申请 APIKey，我自己申请了一个<code>479ce48d-db30-46a4-b1a0-91ac4c1477b8</code>。<code>thecatapi</code>要求在请求首部中设置<code>x-api-key</code>为我们申请到的 APIKey。</p>

<p><code>headers</code>可以很方便的实现这个功能，只需要在<code>cli</code>对象上设置一次即可。另外，<code>gentleman</code>会自动在请求中添加一个<code>User-Agent</code>首部，内容是<code>gentleman</code>的版本信息。细心的童鞋可能已经发现了，在上一节的输出中有<code>User-Agent: gentleman/2.0.4</code>这个首部。在本例中，我们使用<code>header.Del()</code>删除这个首部。</p>

<p>输出内容太多，我这里就不贴了。</p>

<h3 id="query"><code>query</code></h3>

<p>HTTP 请求通常会在 URL 的<code>?</code>后带上查询字符串（<code>query string</code>），<code>gentleman</code>的内置插件<code>query</code>可以很好的管理这个信息。我们可以基于上面代码，给请求带上参数<code>page</code>和<code>limit</code>使之分页返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;fmt&#34;</span>

  <span class="s">&#34;gopkg.in/h2non/gentleman.v2&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2/plugins/headers&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2/plugins/query&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">cli</span> <span class="o">:=</span> <span class="nx">gentleman</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">URL</span><span class="p">(</span><span class="s">&#34;https://api.thecatapi.com&#34;</span><span class="p">)</span>

  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">headers</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;x-api-key&#34;</span><span class="p">,</span> <span class="s">&#34;479ce48d-db30-46a4-b1a0-91ac4c1477b8&#34;</span><span class="p">))</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">query</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;attach_breed&#34;</span><span class="p">,</span> <span class="s">&#34;beng&#34;</span><span class="p">))</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">query</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;limit&#34;</span><span class="p">,</span> <span class="s">&#34;2&#34;</span><span class="p">))</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">headers</span><span class="p">.</span><span class="nf">Del</span><span class="p">(</span><span class="s">&#34;User-Agent&#34;</span><span class="p">))</span>

  <span class="nx">req</span> <span class="o">:=</span> <span class="nx">cli</span><span class="p">.</span><span class="nf">Request</span><span class="p">()</span>
  <span class="nx">req</span><span class="p">.</span><span class="nf">Path</span><span class="p">(</span><span class="s">&#34;/v1/breeds&#34;</span><span class="p">)</span>
  <span class="nx">req</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">query</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;page&#34;</span><span class="p">,</span> <span class="s">&#34;1&#34;</span><span class="p">))</span>
  <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Send</span><span class="p">()</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Request error: %s\n&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">!</span><span class="nx">res</span><span class="p">.</span><span class="nx">Ok</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Invalid server response: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Status: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Body: %s&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>品种和每页显示数量最好还是在<code>cli</code>对象中设置，每个请求对象共用：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">query</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;attach_breed&#34;</span><span class="p">,</span> <span class="s">&#34;beng&#34;</span><span class="p">))</span>
<span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">query</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;limit&#34;</span><span class="p">,</span> <span class="s">&#34;2&#34;</span><span class="p">))</span></code></pre></td></tr></table>
</div>
</div>
<p>当前请求的页数在<code>req</code>对象上设置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">req</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">query</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;page&#34;</span><span class="p">,</span> <span class="s">&#34;1&#34;</span><span class="p">))</span></code></pre></td></tr></table>
</div>
</div>
<p>其他的代码与上一个示例完全一样。除了设置<code>query string</code>，还可以通过<code>query.Del()</code>删除某个键值对。</p>

<h3 id="url"><code>url</code></h3>

<p>路径参数有些时候很有用，因为我们在开发中时常会碰到相似的路径，只是中间某个部分不一样，例如<code>/info/user/1</code>，<code>/info/book/1</code>等。重复写这些路径不仅很枯燥，而且容易出错。于是，偷懒的程序员发明了路径参数，形如<code>/info/:class/1</code>，我们可以传入参数<code>user</code>或<code>book</code>组成完整的路径。<code>gentleman</code>内置了插件<code>url</code>用来处理路径参数问题：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;fmt&#34;</span>
  <span class="s">&#34;os&#34;</span>

  <span class="s">&#34;gopkg.in/h2non/gentleman.v2&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2/plugins/headers&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2/plugins/url&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">cli</span> <span class="o">:=</span> <span class="nx">gentleman</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">URL</span><span class="p">(</span><span class="s">&#34;https://api.thecatapi.com/&#34;</span><span class="p">)</span>

  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">headers</span><span class="p">.</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;x-api-key&#34;</span><span class="p">,</span> <span class="s">&#34;479ce48d-db30-46a4-b1a0-91ac4c1477b8&#34;</span><span class="p">))</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nf">Path</span><span class="p">(</span><span class="s">&#34;/v1/:type&#34;</span><span class="p">))</span>

  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">arg</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">{</span>
    <span class="nx">req</span> <span class="o">:=</span> <span class="nx">cli</span><span class="p">.</span><span class="nf">Request</span><span class="p">()</span>
    <span class="nx">req</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">url</span><span class="p">.</span><span class="nf">Param</span><span class="p">(</span><span class="s">&#34;type&#34;</span><span class="p">,</span> <span class="nx">arg</span><span class="p">))</span>
    <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Send</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
      <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Request error: %s\n&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
      <span class="k">return</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">!</span><span class="nx">res</span><span class="p">.</span><span class="nx">Ok</span> <span class="p">{</span>
      <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Invalid server response: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
      <span class="k">return</span>
    <span class="p">}</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Status: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Body: %s\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>thecatapi</code>除了可以获取猫的品种，还有用户投票、各种分类信息。它们的请求路径都差不多，<code>/v1/breeds</code>、<code>/v1/votes</code>、<code>/v1/categories</code>。我们使用<code>url</code>简化程序编写。上面程序在客户端对象<code>cli</code>上使用插件<code>url.Path(&quot;/v1/:type&quot;)</code>，调用<code>url.Param(&quot;type&quot;, arg)</code>用命令行中的参数分别替换<code>type</code>进行 HTTP 请求。运行程序：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="err">$</span> <span class="k">go</span> <span class="nx">run</span> <span class="nx">main</span><span class="p">.</span><span class="k">go</span> <span class="nx">breeds</span> <span class="nx">votes</span> <span class="nx">categories</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="其他">其他</h3>

<p><code>gentleman</code>内置了将近 20 个插件，有身份认证相关的<code>auth</code>、有<code>cookies</code>、有压缩相关的<code>compression</code>、有代理相关的<code>proxy</code>、有重定向相关的<code>redirect</code>、有超时相关的<code>timeout</code>、有重试的<code>retry</code>、有服务发现的<code>consul</code>等等等等。感兴趣可自行去探索。</p>

<h3 id="自定义">自定义</h3>

<p>如果内置的和第三方的插件都不能满足我们的需求，我们还可以自定义插件。自定义的插件需要实现下面的接口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/gopkg.in/h2non/gentleman.v2/plugin/plugin.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Plugin</span> <span class="kd">interface</span> <span class="p">{</span>
  <span class="nf">Enable</span><span class="p">()</span>
  <span class="nf">Disable</span><span class="p">()</span>
  <span class="nf">Disabled</span><span class="p">()</span> <span class="kt">bool</span>
  <span class="nf">Remove</span><span class="p">()</span>
  <span class="nf">Removed</span><span class="p">()</span> <span class="kt">bool</span>
  <span class="nf">Exec</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="o">*</span><span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">context</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p><code>Exec()</code>方法在 HTTP 请求的各个生命周期都会调用，可以在请求前添加一些首部、删除查询字符串，响应返回后进行一些处理等。</p>

<p>通过实现<code>Plugin</code>接口的方式实现插件比较繁琐，且很多插件往往只关注生命周期的某个点，不用处理所有的生命周期事件。<code>gentleman</code>提供了一个<code>Layer</code>结构，可以注册某个生命周期的方法，同时提供<code>NewRequestPlugin/NewResponsePlugin/NewErrorPlugin</code>等便捷函数。</p>

<p>我们现在来实现一个插件，在请求之前输出一行信息，收到响应之后输出一行信息：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;fmt&#34;</span>

  <span class="s">&#34;gopkg.in/h2non/gentleman.v2&#34;</span>
  <span class="nx">c</span> <span class="s">&#34;gopkg.in/h2non/gentleman.v2/context&#34;</span>
  <span class="s">&#34;gopkg.in/h2non/gentleman.v2/plugin&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">cli</span> <span class="o">:=</span> <span class="nx">gentleman</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>
  <span class="nx">cli</span><span class="p">.</span><span class="nf">URL</span><span class="p">(</span><span class="s">&#34;https://httpbin.org&#34;</span><span class="p">)</span>

  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">plugin</span><span class="p">.</span><span class="nf">NewRequestPlugin</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">ctx</span> <span class="o">*</span><span class="nx">c</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">h</span> <span class="nx">c</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;request&#34;</span><span class="p">)</span>

    <span class="nx">h</span><span class="p">.</span><span class="nf">Next</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span>
  <span class="p">}))</span>

  <span class="nx">cli</span><span class="p">.</span><span class="nf">Use</span><span class="p">(</span><span class="nx">plugin</span><span class="p">.</span><span class="nf">NewResponsePlugin</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">ctx</span> <span class="o">*</span><span class="nx">c</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">h</span> <span class="nx">c</span><span class="p">.</span><span class="nx">Handler</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;response&#34;</span><span class="p">)</span>

    <span class="nx">h</span><span class="p">.</span><span class="nf">Next</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span>
  <span class="p">}))</span>

  <span class="nx">req</span> <span class="o">:=</span> <span class="nx">cli</span><span class="p">.</span><span class="nf">Request</span><span class="p">()</span>
  <span class="nx">req</span><span class="p">.</span><span class="nf">Path</span><span class="p">(</span><span class="s">&#34;/headers&#34;</span><span class="p">)</span>
  <span class="nx">res</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">Send</span><span class="p">()</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Request error: %s\n&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">!</span><span class="nx">res</span><span class="p">.</span><span class="nx">Ok</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Invalid server response: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Status: %d\n&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nx">StatusCode</span><span class="p">)</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;Body: %s&#34;</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>由于<code>NewRequestPlugin/NewResponsePlugin</code>这些便利函数，我们只需要实现一个类型为<code>func(ctx *c.Context, h c.Handler)</code>的函数即可，在<code>ctx</code>中有<code>Request</code>和<code>Response</code>等信息，可以在发起请求前对请求进行一些操作以及获得响应时对响应进行一些操作。上面只是简单地输出信息。</p>

<h2 id="总结">总结</h2>

<p>使用<code>gentleman</code>可以实现灵活、便捷的 HTTP 客户端，它提供了丰富的插件，用起来吧~</p>

<p>大家如果发现好玩、好用的 Go 语言库，欢迎到 Go 每日一库 GitHub 上提交 issue😄</p>

<h2 id="参考">参考</h2>

<ol>
<li>gentleman GitHub：<a href="https://github.com/h2non/gentleman">https://github.com/h2non/gentleman</a></li>
<li>Go 每日一库 GitHub：<a href="https://github.com/darjun/go-daily-lib">https://github.com/darjun/go-daily-lib</a></li>
</ol>

<h2 id="我">我</h2>

<p>我的博客：<a href="https://darjun.github.io">https://darjun.github.io</a></p>

<p>欢迎关注我的微信公众号【GoUpUp】，共同学习，一起进步~</p>

<p><img src="/img/wxgzh8.jpg#center" alt="" /></p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">darjun</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2020-04-07
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/2020/04/12/godailylib/plot/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Go 每日一库之 plot</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/2020/04/05/godailylib/gopsutil/">
            <span class="next-text nav-default">Go 每日一库之 gopsutil</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "darjun/blog-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:leedarjun@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/darjun" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://darjun.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2018 -
    2021
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        大俊
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.dee43230127a73d039a734510fa896c89c3c7ce0cf0be0c7a7433f8fd69b76dc.js" integrity="sha256-3uQyMBJ6c9A5pzRRD6iWyJw8fODPC&#43;DHp0M/j9abdtw=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>












</body>
</html>
