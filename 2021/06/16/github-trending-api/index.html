<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>用 Go 实现一个 GitHub Trending API - 大俊的博客</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="darjun" />
  <meta name="description" content="背景 上一篇文章Go 每日一库之 bubbletea我们介绍了炫酷的 TUI 程序框架 — bubbletea。最后实现了一个拉取 GitHub Trending 仓库，并显示在控制台的程" />

  <meta name="keywords" content="大俊, 大俊的博客, go, golang, gopher" />






<meta name="generator" content="Hugo 0.84.0-DEV" />


<link rel="canonical" href="https://darjun.github.io/2021/06/16/github-trending-api/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.fa3d941d1d0e0ddc985804227feabffea55c89883eb0af34e0532a7ae9135151.css" integrity="sha256-&#43;j2UHR0ODdyYWAQif&#43;q//qVciYg&#43;sK804FMqeukTUVE=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/custom.css">


<meta property="og:title" content="用 Go 实现一个 GitHub Trending API" />
<meta property="og:description" content="背景 上一篇文章Go 每日一库之 bubbletea我们介绍了炫酷的 TUI 程序框架 — bubbletea。最后实现了一个拉取 GitHub Trending 仓库，并显示在控制台的程" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://darjun.github.io/2021/06/16/github-trending-api/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-16T07:35:23&#43;00:00" />
<meta property="article:modified_time" content="2021-06-16T07:35:23&#43;00:00" />

<meta itemprop="name" content="用 Go 实现一个 GitHub Trending API">
<meta itemprop="description" content="背景 上一篇文章Go 每日一库之 bubbletea我们介绍了炫酷的 TUI 程序框架 — bubbletea。最后实现了一个拉取 GitHub Trending 仓库，并显示在控制台的程"><meta itemprop="datePublished" content="2021-06-16T07:35:23&#43;00:00" />
<meta itemprop="dateModified" content="2021-06-16T07:35:23&#43;00:00" />
<meta itemprop="wordCount" content="3478">
<meta itemprop="keywords" content="Go," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="用 Go 实现一个 GitHub Trending API"/>
<meta name="twitter:description" content="背景 上一篇文章Go 每日一库之 bubbletea我们介绍了炫酷的 TUI 程序框架 — bubbletea。最后实现了一个拉取 GitHub Trending 仓库，并显示在控制台的程"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-42862533-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">大俊</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/">首页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/about/">关于我</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/darjun" rel="noopener" target="_blank">
              Github
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      大俊
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/">首页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/about/">关于我</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/darjun" rel="noopener" target="_blank">
              Github
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">用 Go 实现一个 GitHub Trending API</h1>
      
      <div class="post-meta">
        <time datetime="2021-06-16" class="post-time">
          2021-06-16
        </time>
        <div class="post-category">
            <a href="https://darjun.github.io/categories/go/"> Go </a>
            
          </div>
        <span class="more-meta"> 约 3478 字 </span>
          <span class="more-meta"> 预计阅读 7 分钟 </span>

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#背景">背景</a></li>
    <li><a href="#先观察">先观察</a></li>
    <li><a href="#准备">准备</a></li>
    <li><a href="#开爬">开爬</a></li>
    <li><a href="#接口设计">接口设计</a>
      <ul>
        <li><a href="#选项">选项</a></li>
        <li><a href="#简单方法">简单方法</a></li>
        <li><a href="#使用效果">使用效果</a></li>
        <li><a href="#文档">文档</a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
    <li><a href="#参考">参考</a></li>
    <li><a href="#我">我</a></li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <h2 id="背景">背景</h2>
<p>上一篇文章<a href="https://darjun.github.io/2021/06/11/godailylib/bubbletea/">Go 每日一库之 bubbletea</a>我们介绍了炫酷的 TUI 程序框架 — <a href="https://github.com/charmbracelet/bubbletea"><code>bubbletea</code></a>。最后实现了一个拉取 GitHub Trending 仓库，并显示在控制台的程序。由于 GitHub 没有提供官方的 Trending API，我们用<code>goquery</code>自己实现了一个。上篇文章由于篇幅关系，没有介绍如何实现。本文我整理了一下代码，并以单独的代码库形式开放出来。</p>
<h2 id="先观察">先观察</h2>
<p>首先，我们来观察一下 GitHub Trending 的结构：</p>
<p><img src="/img/in-post/opensource/trending1.png#center" alt=""></p>
<p>左上角可以切换仓库（Repositories）和开发者（Developers）。右边可以选择语言（Spoken Language，本地语言，汉语、英文等）、语言（Language，编程语言，Golang、C++等）和时间范围（Date Range，支持 3 个维度，Today、This week、This month）。</p>
<p>然后下面是每个仓库的信息：</p>
<p>① 仓库作者和名字</p>
<p>② 仓库描述</p>
<p>③ 主要使用的编程语言（创建仓库时设置的），也可能没有</p>
<p>④ 星数</p>
<p>⑤ fork 数</p>
<p>⑥ 贡献者列表</p>
<p>⑦ 选定的时间范围内（Today、This week、This month）新增多少星数</p>
<p>开发者页面也是类似的，只不过信息少了很多：</p>
<p><img src="/img/in-post/opensource/trending2.png#center" alt=""></p>
<p>① 作者信息</p>
<p>② 最火的仓库信息</p>
<p>注意到切换的开发者页面后，URL 变成为<code>github.com/trending/developers</code>。另外当我们选择本地语言为中文、开发语言为 Go 和时间范围为 Today 后，URL 变为<code>https://github.com/trending/go?since=daily&amp;spoken_language_code=zh</code>，通过在 query-string 中增加相应的键值对表示这种选择。</p>
<h2 id="准备">准备</h2>
<p>在 GitHub 上创建仓库<code>ghtrending</code>，clone 到本地，执行<code>go mod init</code>初始化：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cmd" data-lang="cmd">$ go mod init github.com/darjun/ghtrending
</code></pre></td></tr></table>
</div>
</div><p>然后执行<code>go get</code>下载<code>goquery</code>库：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cmd" data-lang="cmd">$ go get github.com/PuerkitoBio/goquery
</code></pre></td></tr></table>
</div>
</div><p>根据仓库和开发者的信息定义两个结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">Repository</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">Author</span>  <span class="kt">string</span>
  <span class="nx">Name</span>    <span class="kt">string</span>
  <span class="nx">Link</span>    <span class="kt">string</span>
  <span class="nx">Desc</span>    <span class="kt">string</span>
  <span class="nx">Lang</span>    <span class="kt">string</span>
  <span class="nx">Stars</span>   <span class="kt">int</span>
  <span class="nx">Forks</span>   <span class="kt">int</span>
  <span class="nx">Add</span>     <span class="kt">int</span>
  <span class="nx">BuiltBy</span> <span class="p">[]</span><span class="kt">string</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">Developer</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">Name</span>        <span class="kt">string</span>
  <span class="nx">Username</span>    <span class="kt">string</span>
  <span class="nx">PopularRepo</span> <span class="kt">string</span>
  <span class="nx">Desc</span>        <span class="kt">string</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="开爬">开爬</h2>
<p>要想使用<code>goquery</code>获取相应的信息，我们首先要知道，对应的网页结构。按 F12 打开 chrome 开发者工具，选择<code>Elements</code>页签，即可看到网页结构：</p>
<p><img src="/img/in-post/opensource/trending3.png#center" alt=""></p>
<p>使用左上角的按钮就可以很快速的查看网页上任何内容的结构，我们点击单个仓库条目：</p>
<p><img src="/img/in-post/opensource/trending4.png#center" alt=""></p>
<p>右边<code>Elements</code>窗口显示每个仓库条目对应一个<code>article</code>元素：</p>
<p><img src="/img/in-post/opensource/trending5.png#center" alt=""></p>
<p>可以使用标准库<code>net/http</code>获取整个网页的内容：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">resp</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="s">&#34;https://github.com/trending&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>然后从<code>resp</code>对象中创建<code>goquery</code>文档结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">doc</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">goquery</span><span class="p">.</span><span class="nf">NewDocumentFromReader</span><span class="p">(</span><span class="nx">resp</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>有了文档结构对象，我们可以调用其<code>Find()</code>方法，传入选择器，这里我选择<code>.Box .Box-row</code>。<code>.Box</code>是整个列表<code>div</code>的 class，<code>.Box-row</code>是仓库条目的 class。这样的选择更精准。<code>Find()</code>方法返回一个<code>*goquery.Selection</code>对象，我们可以调用其<code>Each()</code>方法对每个条目进行解析。<code>Each()</code>接收一个<code>func(int, *goquery.Selection)</code>类型的函数，第二个参数即为每个仓库条目在 goquery 中的结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">doc</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;.Box .Box-row&#34;</span><span class="p">).</span><span class="nf">Each</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">s</span> <span class="o">*</span><span class="nx">goquery</span><span class="p">.</span><span class="nx">Selection</span><span class="p">)</span> <span class="p">{</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来我们看看如何提取各个部分。在<code>Elements</code>窗口中移动，可以很直观的看到每个元素对应页面的哪个部分：</p>
<p><img src="/img/in-post/opensource/trending6.gif#center" alt=""></p>
<p>我们找到仓库名和作者对应的结构：</p>
<p><img src="/img/in-post/opensource/trending7.png#center" alt=""></p>
<p>它被包在<code>article</code>元素下的<code>h1</code>元素下的<code>a</code>元素内，作者名在<code>span</code>元素内，仓库名直接在<code>a</code>下，另外仓库的 URL 链接是<code>a</code>元素的<code>href</code>属性。我们来获取它们：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">titleSel</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;h1 a&#34;</span><span class="p">)</span>
<span class="nx">repo</span><span class="p">.</span><span class="nx">Author</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">Trim</span><span class="p">(</span><span class="nx">titleSel</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;span&#34;</span><span class="p">).</span><span class="nf">Text</span><span class="p">(),</span> <span class="s">&#34;/\n &#34;</span><span class="p">)</span>
<span class="nx">repo</span><span class="p">.</span><span class="nx">Name</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">TrimSpace</span><span class="p">(</span><span class="nx">titleSel</span><span class="p">.</span><span class="nf">Contents</span><span class="p">().</span><span class="nf">Last</span><span class="p">().</span><span class="nf">Text</span><span class="p">())</span>
<span class="nx">relativeLink</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">titleSel</span><span class="p">.</span><span class="nf">Attr</span><span class="p">(</span><span class="s">&#34;href&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">relativeLink</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
  <span class="nx">repo</span><span class="p">.</span><span class="nx">Link</span> <span class="p">=</span> <span class="s">&#34;https://github.com&#34;</span> <span class="o">+</span> <span class="nx">relativeLink</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>仓库描述在<code>article</code>元素内的<code>p</code>元素中：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">repo</span><span class="p">.</span><span class="nx">Desc</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">TrimSpace</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;p&#34;</span><span class="p">).</span><span class="nf">Text</span><span class="p">())</span>
</code></pre></td></tr></table>
</div>
</div><p>编程语言，星数，fork 数，贡献者（<code>BuiltBy</code>）和新增星数都在<code>article</code>元素的最后一个<code>div</code>中。编程语言、<code>BuiltBy</code>和新增星数在<code>span</code>元素内，星数和 fork 数在<code>a</code>元素内。如果编程语言未设置，则少一个<code>span</code>元素：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">var</span> <span class="nx">langIdx</span><span class="p">,</span> <span class="nx">addIdx</span><span class="p">,</span> <span class="nx">builtByIdx</span> <span class="kt">int</span>
<span class="nx">spanSel</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;div&gt;span&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">spanSel</span><span class="p">.</span><span class="nf">Size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">{</span>
  <span class="c1">// language not exist
</span><span class="c1"></span>  <span class="nx">langIdx</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="nx">addIdx</span> <span class="p">=</span> <span class="mi">1</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">builtByIdx</span> <span class="p">=</span> <span class="mi">1</span>
  <span class="nx">addIdx</span> <span class="p">=</span> <span class="mi">2</span>
<span class="p">}</span>

<span class="c1">// language
</span><span class="c1"></span><span class="k">if</span> <span class="nx">langIdx</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">{</span>
  <span class="nx">repo</span><span class="p">.</span><span class="nx">Lang</span> <span class="p">=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">TrimSpace</span><span class="p">(</span><span class="nx">spanSel</span><span class="p">.</span><span class="nf">Eq</span><span class="p">(</span><span class="nx">langIdx</span><span class="p">).</span><span class="nf">Text</span><span class="p">())</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">repo</span><span class="p">.</span><span class="nx">Lang</span> <span class="p">=</span> <span class="s">&#34;unknown&#34;</span>
<span class="p">}</span>

<span class="c1">// add
</span><span class="c1"></span><span class="nx">addParts</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">SplitN</span><span class="p">(</span><span class="nx">strings</span><span class="p">.</span><span class="nf">TrimSpace</span><span class="p">(</span><span class="nx">spanSel</span><span class="p">.</span><span class="nf">Eq</span><span class="p">(</span><span class="nx">addIdx</span><span class="p">).</span><span class="nf">Text</span><span class="p">()),</span> <span class="s">&#34; &#34;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nx">repo</span><span class="p">.</span><span class="nx">Add</span><span class="p">,</span> <span class="nx">_</span> <span class="p">=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Atoi</span><span class="p">(</span><span class="nx">addParts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">// builtby
</span><span class="c1"></span><span class="nx">spanSel</span><span class="p">.</span><span class="nf">Eq</span><span class="p">(</span><span class="nx">builtByIdx</span><span class="p">).</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;a&gt;img&#34;</span><span class="p">).</span><span class="nf">Each</span><span class="p">(</span><span class="kd">func</span><span class="p">(</span><span class="nx">i</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">img</span> <span class="o">*</span><span class="nx">goquery</span><span class="p">.</span><span class="nx">Selection</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">src</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">img</span><span class="p">.</span><span class="nf">Attr</span><span class="p">(</span><span class="s">&#34;src&#34;</span><span class="p">)</span>
  <span class="nx">repo</span><span class="p">.</span><span class="nx">BuiltBy</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">repo</span><span class="p">.</span><span class="nx">BuiltBy</span><span class="p">,</span> <span class="nx">src</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>然后是星数和 fork 数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">aSel</span> <span class="o">:=</span> <span class="nx">s</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="s">&#34;div&gt;a&#34;</span><span class="p">)</span>
<span class="nx">starStr</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">TrimSpace</span><span class="p">(</span><span class="nx">aSel</span><span class="p">.</span><span class="nf">Eq</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">).</span><span class="nf">Text</span><span class="p">())</span>
<span class="nx">star</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Atoi</span><span class="p">(</span><span class="nx">strings</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="nx">starStr</span><span class="p">,</span> <span class="s">&#34;,&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="nx">repo</span><span class="p">.</span><span class="nx">Stars</span> <span class="p">=</span> <span class="nx">star</span>
<span class="nx">forkStr</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">TrimSpace</span><span class="p">(</span><span class="nx">aSel</span><span class="p">.</span><span class="nf">Eq</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nf">Text</span><span class="p">())</span>
<span class="nx">fork</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nf">Atoi</span><span class="p">(</span><span class="nx">strings</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="nx">forkStr</span><span class="p">,</span> <span class="s">&#34;,&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="nx">repo</span><span class="p">.</span><span class="nx">Forks</span> <span class="p">=</span> <span class="nx">fork</span>
</code></pre></td></tr></table>
</div>
</div><p>Developers 也是类似的做法。这里就不赘述了。使用<code>goquery</code>有一点需要注意，因为网页层级结构比较复杂，<strong>我们使用选择器的时候尽量多限定一些元素、class，以确保找到的确实是我们想要的那个结构</strong>。另外网页上获取的内容有很多空格，需要使用<code>strings.TrimSpace()</code>移除。</p>
<h2 id="接口设计">接口设计</h2>
<p>基本工作完成之后，我们来看看如何设计接口。我想提供一个类型和一个创建该类型对象的方法，然后调用对象的<code>FetchRepos()</code>和<code>FetchDevelopers()</code>方法就可以获取仓库和开发者列表。但是我不希望用户了解这个类型的细节。所以我定义了一个接口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">Fetcher</span> <span class="kd">interface</span> <span class="p">{</span>
  <span class="nf">FetchRepos</span><span class="p">()</span> <span class="p">([]</span><span class="o">*</span><span class="nx">Repository</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
  <span class="nf">FetchDevelopers</span><span class="p">()</span> <span class="p">([]</span><span class="o">*</span><span class="nx">Developer</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>我们定义一个类型来实现这个接口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">trending</span> <span class="kd">struct</span><span class="p">{}</span>

<span class="kd">func</span> <span class="nf">New</span><span class="p">()</span> <span class="nx">Fetcher</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">&amp;</span><span class="nx">trending</span><span class="p">{}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="nx">trending</span><span class="p">)</span> <span class="nf">FetchRepos</span><span class="p">()</span> <span class="p">([]</span><span class="o">*</span><span class="nx">Repository</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="nx">trending</span><span class="p">)</span> <span class="nf">FetchDevelopers</span><span class="p">()</span> <span class="p">([]</span><span class="o">*</span><span class="nx">Developer</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>我们上面介绍的爬取逻辑就是放在<code>FetchRepos()</code>和<code>FetchDevelopers()</code>方法中。</p>
<p>然后，我们就可以在其他地方使用了：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">import</span> <span class="s">&#34;github.com/darjun/ghtrending&#34;</span>

<span class="nx">t</span> <span class="o">:=</span> <span class="nx">ghtrending</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>
<span class="nx">repos</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">FetchRepos</span><span class="p">()</span>

<span class="nx">developers</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">FetchDevelopers</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="选项">选项</h3>
<p>前面也说过，GitHub Trending 支持选定本地语言、编程语言和时间范围等。我们希望把这些设置作为选项，使用 Go 语言常用的选项模式/函数式选项（functional option)。先定义选项结构：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">options</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">GitHubURL</span>  <span class="kt">string</span>
  <span class="nx">SpokenLang</span> <span class="kt">string</span>
  <span class="nx">Language</span>   <span class="kt">string</span> <span class="c1">// programming language
</span><span class="c1"></span>  <span class="nx">DateRange</span>  <span class="kt">string</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">option</span> <span class="kd">func</span><span class="p">(</span><span class="o">*</span><span class="nx">options</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>然后定义 3 个<code>DataRange</code>选项：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">WithDaily</span><span class="p">()</span> <span class="nx">option</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">opt</span> <span class="o">*</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">opt</span><span class="p">.</span><span class="nx">DateRange</span> <span class="p">=</span> <span class="s">&#34;daily&#34;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">WithWeekly</span><span class="p">()</span> <span class="nx">option</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">opt</span> <span class="o">*</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">opt</span><span class="p">.</span><span class="nx">DateRange</span> <span class="p">=</span> <span class="s">&#34;weekly&#34;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">WithMonthly</span><span class="p">()</span> <span class="nx">option</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">opt</span> <span class="o">*</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">opt</span><span class="p">.</span><span class="nx">DateRange</span> <span class="p">=</span> <span class="s">&#34;monthly&#34;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>以后可能还有其他范围的时间，留一个通用一点的选项：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">WithDateRange</span><span class="p">(</span><span class="nx">dr</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">option</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">opt</span> <span class="o">*</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">opt</span><span class="p">.</span><span class="nx">DateRange</span> <span class="p">=</span> <span class="nx">dr</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>编程语言选项：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">WithLanguage</span><span class="p">(</span><span class="nx">lang</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">option</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">opt</span> <span class="o">*</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">opt</span><span class="p">.</span><span class="nx">Language</span> <span class="p">=</span> <span class="nx">lang</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>本地语言选项，国家和代码分开，例如 Chinese 的代码为 cn：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">WithSpokenLanguageCode</span><span class="p">(</span><span class="nx">code</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">option</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">opt</span> <span class="o">*</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">opt</span><span class="p">.</span><span class="nx">SpokenLang</span> <span class="p">=</span> <span class="nx">code</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">WithSpokenLanguageFull</span><span class="p">(</span><span class="nx">lang</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">option</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">opt</span> <span class="o">*</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">opt</span><span class="p">.</span><span class="nx">SpokenLang</span> <span class="p">=</span> <span class="nx">spokenLangCode</span><span class="p">[</span><span class="nx">lang</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>spokenLangCode</code>是 GitHub 支持的国家和代码的对照，我是从 GitHub Trending 页面爬取的。大概是这样的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">var</span> <span class="p">(</span>
  <span class="nx">spokenLangCode</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">spokenLangCode</span> <span class="p">=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
    <span class="s">&#34;abkhazian&#34;</span><span class="p">:</span>             <span class="s">&#34;ab&#34;</span><span class="p">,</span>
    <span class="s">&#34;afar&#34;</span><span class="p">:</span>                  <span class="s">&#34;aa&#34;</span><span class="p">,</span>
    <span class="s">&#34;afrikaans&#34;</span><span class="p">:</span>             <span class="s">&#34;af&#34;</span><span class="p">,</span>
    <span class="s">&#34;akan&#34;</span><span class="p">:</span>                  <span class="s">&#34;ak&#34;</span><span class="p">,</span>
    <span class="s">&#34;albanian&#34;</span><span class="p">:</span>              <span class="s">&#34;sq&#34;</span><span class="p">,</span>
    <span class="c1">// ...
</span><span class="c1"></span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>最后我希望 GitHub 的 URL 也可以设置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">WithURL</span><span class="p">(</span><span class="nx">url</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">option</span> <span class="p">{</span>
  <span class="k">return</span> <span class="kd">func</span><span class="p">(</span><span class="nx">opt</span> <span class="o">*</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">opt</span><span class="p">.</span><span class="nx">GitHubURL</span> <span class="p">=</span> <span class="nx">url</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>我们在<code>trending</code>结构中增加<code>options</code>字段，然后改造一下<code>New()</code>方法，让它接受可变参数的选项。这样我们只需要设置我们想要设置的，其他的选项都可以采用默认值，例如<code>GitHubURL</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">trending</span> <span class="kd">struct</span> <span class="p">{</span>
  <span class="nx">opts</span> <span class="nx">options</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">loadOptions</span><span class="p">(</span><span class="nx">opts</span> <span class="o">...</span><span class="nx">option</span><span class="p">)</span> <span class="nx">options</span> <span class="p">{</span>
  <span class="nx">o</span> <span class="o">:=</span> <span class="nx">options</span><span class="p">{</span>
    <span class="nx">GitHubURL</span><span class="p">:</span> <span class="s">&#34;http://github.com&#34;</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">option</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">opts</span> <span class="p">{</span>
    <span class="nf">option</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">o</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">o</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">New</span><span class="p">(</span><span class="nx">opts</span> <span class="o">...</span><span class="nx">option</span><span class="p">)</span> <span class="nx">Fetcher</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">&amp;</span><span class="nx">trending</span><span class="p">{</span>
    <span class="nx">opts</span><span class="p">:</span> <span class="nf">loadOptions</span><span class="p">(</span><span class="nx">opts</span><span class="o">...</span><span class="p">),</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>最后在<code>FetchRepos()</code>方法和<code>FetchDevelopers()</code>方法中根据选项拼接 URL：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s/trending/%s?spoken_language_code=%s&amp;since=%s&#34;</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">GitHubURL</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">Language</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">SpokenLang</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">DateRange</span><span class="p">)</span>

<span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;%s/trending/developers?lanugage=%s&amp;since=%s&#34;</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">GitHubURL</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">Language</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="nx">opts</span><span class="p">.</span><span class="nx">DateRange</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>加入选项之后，如果我们要获取一周内的，Go 语言 Trending 列表，可以这样：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">t</span> <span class="o">:=</span> <span class="nx">ghtrending</span><span class="p">.</span><span class="nf">New</span><span class="p">(</span><span class="nx">ghtrending</span><span class="p">.</span><span class="nf">WithWeekly</span><span class="p">(),</span> <span class="nx">ghtreading</span><span class="p">.</span><span class="nf">WithLanguage</span><span class="p">(</span><span class="s">&#34;Go&#34;</span><span class="p">))</span>
<span class="nx">repos</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">FetchRepos</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="简单方法">简单方法</h3>
<p>另外，我们还提供一个不需要创建<code>trending</code>对象，直接调用接口获取仓库和开发者列表的方法（懒人专用）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">TrendingRepositories</span><span class="p">(</span><span class="nx">opts</span> <span class="o">...</span><span class="nx">option</span><span class="p">)</span> <span class="p">([]</span><span class="o">*</span><span class="nx">Repository</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nf">New</span><span class="p">(</span><span class="nx">opts</span><span class="o">...</span><span class="p">).</span><span class="nf">FetchRepos</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">TrendingDevelopers</span><span class="p">(</span><span class="nx">opts</span> <span class="o">...</span><span class="nx">option</span><span class="p">)</span> <span class="p">([]</span><span class="o">*</span><span class="nx">Developer</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nf">New</span><span class="p">(</span><span class="nx">opts</span><span class="o">...</span><span class="p">).</span><span class="nf">FetchDevelopers</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="使用效果">使用效果</h3>
<p>新建目录并初始化 Go Modules：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cmd" data-lang="cmd">$ mkdir -p demo/ghtrending <span class="p">&amp;&amp;</span> <span class="k">cd</span> demo/ghtrending
$ go mod init github/darjun/demo/ghtrending
</code></pre></td></tr></table>
</div>
</div><p>下载包：</p>
<p><img src="/img/in-post/opensource/trending9.png#center" alt=""></p>
<p>编写代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
  <span class="s">&#34;fmt&#34;</span>
  <span class="s">&#34;log&#34;</span>

  <span class="s">&#34;github.com/darjun/ghtrending&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">t</span> <span class="o">:=</span> <span class="nx">ghtrending</span><span class="p">.</span><span class="nf">New</span><span class="p">()</span>

  <span class="nx">repos</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">FetchRepos</span><span class="p">()</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">log</span><span class="p">.</span><span class="nf">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%d repos\n&#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nx">repos</span><span class="p">))</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;first repo:%#v\n&#34;</span><span class="p">,</span> <span class="nx">repos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

  <span class="nx">developers</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nf">FetchDevelopers</span><span class="p">()</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="nx">log</span><span class="p">.</span><span class="nf">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%d developers\n&#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nx">developers</span><span class="p">))</span>
  <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;first developer:%#v\n&#34;</span><span class="p">,</span> <span class="nx">developers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>运行效果：</p>
<p><img src="/img/in-post/opensource/trending10.png#center" alt=""></p>
<h3 id="文档">文档</h3>
<p>最后，我们加点文档：</p>
<p><img src="/img/in-post/opensource/trending8.png#center" alt=""></p>
<p>一个小开源库就完成了。</p>
<h2 id="总结">总结</h2>
<p>本文介绍如何使用<code>goquery</code>爬取网页。着重介绍了<code>ghtrending</code>的接口设计。在编写一个库的时候，应该提供易用的、最小化的接口。用户不需要了解库的实现细节就可以使用。<code>ghtrending</code>使用函数式选项就是一个例子，有需要才传递，无需要可不提供。</p>
<p>自己通过爬取网页的方式来获取 Trending 列表比较容易受限制，例如过段时间 GitHub 网页结构变了，代码就不得不做适配。在官方没有提供 API 的情况下，目前也只能这么做了。</p>
<p>大家如果发现好玩、好用的 Go 语言库，欢迎到 Go 每日一库 GitHub 上提交 issue😄</p>
<h2 id="参考">参考</h2>
<ol>
<li>ghtrending GitHub：<a href="https://github.com/darjun/ghtrending">github.com/darjun/ghtrending</a></li>
<li>Go 每日一库之 goquery：<a href="https://darjun.github.io/2020/10/11/godailylib/goquery">https://darjun.github.io/2020/10/11/godailylib/goquery</a></li>
<li>Go 每日一库 GitHub：<a href="https://github.com/darjun/go-daily-lib">https://github.com/darjun/go-daily-lib</a></li>
</ol>
<h2 id="我">我</h2>
<p>我的博客：<a href="https://darjun.github.io">https://darjun.github.io</a></p>
<p>欢迎关注我的微信公众号【GoUpUp】，共同学习，一起进步~</p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">darjun</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2021-06-16
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://darjun.github.io/tags/go/">Go</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/2021/06/20/godailylib/ozzo-validation/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">Go 每日一库之 ozzo-validation</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/2021/06/12/pr/tunny/">
            <span class="next-text nav-default">为 tunny 提交的一次 PR</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "darjun/blog-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:leedarjun@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/darjun" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://darjun.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2018 -
    2021
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        大俊
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.dee43230127a73d039a734510fa896c89c3c7ce0cf0be0c7a7433f8fd69b76dc.js" integrity="sha256-3uQyMBJ6c9A5pzRRD6iWyJw8fODPC&#43;DHp0M/j9abdtw=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>












</body>
</html>
