<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Go Web 编程之 响应 - 大俊的博客</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="darjun" />
  <meta name="description" content="概述 上一篇文章中，我们介绍了请求的结构与处理。本文将详细介绍如何响应客户端的请求。其实在前面几篇文章中，我们已经使用过响应的功能——通过ht" />

  <meta name="keywords" content="大俊, 大俊的博客, go, golang, gopher" />






<meta name="generator" content="Hugo 0.60.0-DEV" />


<link rel="canonical" href="https://darjun.github.io/2019/12/18/goweb/response/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/custom.css">


<meta property="og:title" content="Go Web 编程之 响应" />
<meta property="og:description" content="概述 上一篇文章中，我们介绍了请求的结构与处理。本文将详细介绍如何响应客户端的请求。其实在前面几篇文章中，我们已经使用过响应的功能——通过ht" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://darjun.github.io/2019/12/18/goweb/response/" />
<meta property="article:published_time" content="2019-12-18T21:41:43+00:00" />
<meta property="article:modified_time" content="2019-12-18T21:41:43+00:00" />
<meta itemprop="name" content="Go Web 编程之 响应">
<meta itemprop="description" content="概述 上一篇文章中，我们介绍了请求的结构与处理。本文将详细介绍如何响应客户端的请求。其实在前面几篇文章中，我们已经使用过响应的功能——通过ht">


<meta itemprop="datePublished" content="2019-12-18T21:41:43&#43;00:00" />
<meta itemprop="dateModified" content="2019-12-18T21:41:43&#43;00:00" />
<meta itemprop="wordCount" content="5232">



<meta itemprop="keywords" content="Go Web 编程," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go Web 编程之 响应"/>
<meta name="twitter:description" content="概述 上一篇文章中，我们介绍了请求的结构与处理。本文将详细介绍如何响应客户端的请求。其实在前面几篇文章中，我们已经使用过响应的功能——通过ht"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-42862533-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">大俊</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/">首页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/about/">关于我</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/darjun" rel="noopener" target="_blank">
              Github
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      大俊
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/">首页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://darjun.github.io/about/">关于我</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/darjun" rel="noopener" target="_blank">
              Github
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Go Web 编程之 响应</h1>
      
      <div class="post-meta">
        <time datetime="2019-12-18" class="post-time">
          2019-12-18
        </time>
        <div class="post-category">
            <a href="https://darjun.github.io/categories/go/"> Go </a>
            
          </div>
        <span class="more-meta"> 约 5232 字 </span>
          <span class="more-meta"> 预计阅读 11 分钟 </span>

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#概述">概述</a></li>
<li><a href="#responsewriter-接口"><code>ResponseWriter</code>接口</a>
<ul>
<li><a href="#write-方法"><code>Write</code>方法</a></li>
<li><a href="#writeheader-方法"><code>WriteHeader</code>方法</a></li>
<li><a href="#header-方法"><code>Header</code>方法</a></li>
</ul></li>
<li><a href="#cookie">cookie</a>
<ul>
<li><a href="#概念">概念</a></li>
<li><a href="#重要性">重要性</a></li>
<li><a href="#使用">使用</a></li>
</ul></li>
<li><a href="#总结">总结</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h2 id="概述">概述</h2>

<p>上一篇文章中，我们介绍了请求的结构与处理。本文将详细介绍如何响应客户端的请求。其实在前面几篇文章中，我们已经使用过响应的功能——通过<code>http.ResponseWriter</code>发送字符串给客户端。
但是这种方式仅限于发送字符串。本文我们将介绍如何定制响应的参数。</p>

<h2 id="responsewriter-接口"><code>ResponseWriter</code>接口</h2>

<p>如果你看了我前面几篇文章，应该对处理器和处理器函数都非常熟悉了。处理器函数即拥有以下签名的函数：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>这里的<code>ResponseWriter</code>其实是定义在<code>net/http</code>包中的一个接口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/net/http/
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">ReponseWriter</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nf">Header</span><span class="p">()</span> <span class="nx">Header</span>
    <span class="nf">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span>
    <span class="nf">WriteHeader</span><span class="p">(</span><span class="nx">statusCode</span> <span class="kt">int</span><span class="p">)</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>我们响应客户端请求都是通过该接口的 3 个方法进行的。例如之前<code>fmt.Fprintln(w, &quot;Hello World&quot;)</code>其实底层调用了<code>Write</code>方法。</p>

<p>收到请求后，多路复用器会自动创建一个<code>http.response</code>对象，它实现了<code>http.ResponseWriter</code>接口，然后将该对象和请求对象作为参数传给处理器。那为什么请求对象使用的时结构指针<code>*http.Request</code>，而响应要使用接口呢？</p>

<p>实际上，请求对象使用指针是为了能在处理逻辑中方便地获取请求信息。而响应使用接口来操作，一方面底层也是对象指针，可以保存修改。另一方面，我认为是为了扩展性。可以很方便地用新的实现替换而不用修改应用层代码，即处理器接口不用修改。例如，Go 标准库提供了一个测试 HTTP 请求的工具包<code>net/http/httptest</code>。它定义了一个<code>ResponseRecorder</code>结构，该结构实现了接口<code>http.ResponseWriter</code>。这个结构不将写入的数据发送给客户端，<strong>而是将数据记录下来，方便测试断言</strong>。</p>

<p>接口<code>ResponseWriter</code>有 3 个方法，下面依次来介绍如何使用：</p>

<ul>
<li><code>Write</code>；</li>
<li><code>WriteHeader</code>；</li>
<li><code>Header</code>。</li>
</ul>

<h3 id="write-方法"><code>Write</code>方法</h3>

<p>由于接口<code>ResponseWriter</code>拥有方法<code>Write([]byte) (int, error)</code>，所以实现了<code>ResponseWriter</code>接口的结构也实现了<code>io.Writer</code>接口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/io/io.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Writer</span> <span class="kd">interface</span> <span class="p">{</span>
	<span class="nf">Write</span><span class="p">(</span><span class="nx">p</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="nx">n</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>这也是为什么<code>http.ResponseWriter</code>类型的变量<code>w</code>能在下面代码中使用的原因（<code>fmt.Fprintln</code>的第一个参数接收一个<code>io.Writer</code>接口）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;Hello World&#34;</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>我们也可以直接调用<code>Write</code>方法来向响应中写入数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">writeHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">str</span> <span class="o">:=</span> <span class="s">`&lt;html&gt;
</span><span class="s">&lt;head&gt;&lt;title&gt;Go Web 编程之 响应&lt;/title&gt;&lt;/head&gt;
</span><span class="s">&lt;body&gt;&lt;h1&gt;直接使用 Write 方法&lt;h1&gt;&lt;/body&gt;
</span><span class="s">&lt;/html&gt;`</span>
    <span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">str</span><span class="p">))</span>
<span class="p">}</span>

<span class="nx">mux</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/write&#34;</span><span class="p">,</span> <span class="nx">writeHandler</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>下面，我们介绍一个工具<code>curl</code>来测试我们的 Web 应用。由于浏览器只会展示响应中主体的内容，其它元信息需要进行一些操作才能查看，不够直观。<code>curl</code>是一个 Linux 命令行程序，可用来发起 HTTP 请求，功能非常强大，如设置首部/请求体，展示响应首部等。</p>

<p>通常 Linux 系统会自带<code>curl</code>命令。简单介绍几种 Windows 上安装<code>curl</code>的方式。</p>

<ul>
<li><p>直接在<a href="https://curl.haxx.se/download.html">curl官网</a>下载可执行程序，下载完成后放在<code>PATH</code>目录中即可在<code>Cmd</code>或<code>Powershell</code>界面中使用；</p></li>

<li><p>Windows 提供了一个软件包管理工具<a href="https://chocolatey.org/">chocolatey</a>，可以安装/更新/删除 Windows 软件。安装<code>chocolatey</code>后，直接在<code>Cmd</code>或<code>Powershell</code>界面执行以下命令即可安装<code>curl</code>，也比较方便：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">choco install curl</pre></td></tr></table>
</div>
</div></li>

<li><p>我想作为程序员，每个人都应该熟悉<code>git</code>。安装<a href="https://git-scm.com/download/win">git for windows</a>后，就可以直接在<code>Git Bash</code>中使用<code>curl</code>命令。实际上，<code>git for windows</code>使用了<code>mingw</code>来在 Windows 上模拟 Linux 环境。它提供了很多 Linux 命令的 Windows 版本，非常推荐使用。</p></li>
</ul>

<p>启动服务器，使用下面命令测试<code>Write</code>方法：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">curl -i localhost:8080/write</code></pre></td></tr></table>
</div>
</div>
<p>选项<code>-i</code>的作用是显示响应首部。该命令返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></pre></td>
<td class="lntd">
<pre class="chroma">HTTP/1.1 200 OK
Date: Thu, 19 Dec 2019 13:36:32 GMT
Content-Length: 113
Content-Type: text/html; charset=utf-8

&lt;html&gt;
&lt;head&gt;&lt;title&gt;Go Web 编程之 响应&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;直接使用 Write 方法&lt;h1&gt;&lt;/body&gt;
&lt;/html&gt;</pre></td></tr></table>
</div>
</div>
<p>可以看出很清晰地看出响应的各个部分。也可以继续使用浏览器来测试：</p>

<p><img src="/img/in-post/goweb/response1.png#center" alt="" /></p>

<p>但是如果要查看首部，状态码等信息就必须使用浏览器的开发者工具了。Chrome 的开发者工具可以通过 F12 唤出，然后切换到<code>Network</code>标签，点击刚刚发送的请求：</p>

<p><img src="/img/in-post/goweb/response2.png#center" alt="" /></p>

<p><img src="/img/in-post/goweb/response3.png#center" alt="" /></p>

<p>我们看到上面红色的两个部分为响应的元信息，下面的绿色部分为请求的基本信息。</p>

<p>注意到，如果我们没有设置响应码，则响应码默认为<strong>200</strong>。
而且我们也没有设置内容类型，但是返回的首部中有<code>Content-Type: text/html; charset=utf-8</code>，说明<code>net/http</code>会自动推断。<code>net/http</code>包是通过读取响应体中前面的若干个字节来推断的，并不是百分百准确的。</p>

<p>如何设置状态码和响应内容的类型呢？这就是<code>WriteHeader</code>和<code>Header()</code>两个方法的作用。</p>

<h3 id="writeheader-方法"><code>WriteHeader</code>方法</h3>

<p><code>WriteHeader</code>方法的名字带有一点误导性，它并不能用于设置响应首部。<code>WriteHeader</code>接收一个整数，并将这个整数作为 HTTP 响应的状态码返回。调用这个返回之后，可以继续对<code>ResponseWriter</code>进行写入，但是<strong>不能对响应的首部进行任何修改操作</strong>。如果用户在调用<code>Write</code>方法之前没有执行过<code>WriteHeader</code>方法，那么程序默认会使用 200 作为响应的状态码。</p>

<p>如果，我们定义了一个 API，还未定义其实现。那么请求这个 API 时，可以返回一个 501 Not Implemented 作为状态码。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">writeHeaderHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="mi">501</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;This API not implemented!!!&#34;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">mux</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/writeheader&#34;</span><span class="p">,</span> <span class="nx">writeHeaderHandler</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>使用<code>curl</code>来测试刚刚编写的处理器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">curl -i localhost:8080/writeheader</pre></td></tr></table>
</div>
</div>
<p>返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></pre></td>
<td class="lntd">
<pre class="chroma">HTTP/1.1 501 Not Implemented
Date: Thu, 19 Dec 2019 14:15:16 GMT
Content-Length: 28
Content-Type: text/plain; charset=utf-8

This API not implemented!!!</pre></td></tr></table>
</div>
</div>
<h3 id="header-方法"><code>Header</code>方法</h3>

<p><code>Header</code>方法其实返回的是一个<code>http.Header</code>类型，该类型的底层类型为<code>map[string][]string</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/net/http/header.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Header</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">][]</span><span class="kt">string</span></code></pre></td></tr></table>
</div>
</div>
<p>类型<code>Header</code>定义了 CRUD 方法，可以通过这些方法操作首部。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">headerHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">w</span><span class="p">.</span><span class="nf">Header</span><span class="p">().</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;Location&#34;</span><span class="p">,</span> <span class="s">&#34;http://baidu.com&#34;</span><span class="p">)</span>
    <span class="nx">w</span><span class="p">.</span><span class="nf">WriteHeader</span><span class="p">(</span><span class="mi">302</span><span class="p">)</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>通过第一篇文章我们知道 302 表示重定向，浏览器收到该状态码时会再发起一个请求到首部中<code>Location</code>指向的地址。使用<code>curl</code>测试：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">curl -i localhost:8080/header</pre></td></tr></table>
</div>
</div>
<p>返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">HTTP/1.1 302 Found
Location: http://baidu.com
Date: Thu, 19 Dec 2019 14:17:49 GMT
Content-Length: 0</pre></td></tr></table>
</div>
</div>
<p>如何在浏览器中打开<code>localhost:8080/header</code>，网页会重定向到<a href="http://baidu.com">百度首页</a>。</p>

<p>接下来，我们看看如何设置自定义的内容类型。通过<code>Header.Set</code>方法设置响应的首部<code>Contet-Type</code>即可。我们编写一个返回 JSON 数据的处理器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">type</span> <span class="nx">User</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">FirstName</span>   <span class="kt">string</span>      <span class="s">`json:&#34;first_name&#34;`</span>
    <span class="nx">LastName</span>    <span class="kt">string</span>      <span class="s">`json:&#34;last_name&#34;`</span>
    <span class="nx">Age</span>         <span class="kt">int</span>         <span class="s">`json:&#34;age&#34;`</span>
    <span class="nx">Hobbies</span>     <span class="p">[]</span><span class="kt">string</span>    <span class="s">`json:&#34;hobbies&#34;`</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">jsonHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">w</span><span class="p">.</span><span class="nf">Header</span><span class="p">().</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;Content-Type&#34;</span><span class="p">,</span> <span class="s">&#34;application/json&#34;</span><span class="p">)</span>
    <span class="nx">u</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">User</span> <span class="p">{</span>
        <span class="nx">FirstName</span><span class="p">:</span>  <span class="s">&#34;lee&#34;</span><span class="p">,</span>
        <span class="nx">LastName</span><span class="p">:</span>   <span class="s">&#34;darjun&#34;</span><span class="p">,</span>
        <span class="nx">Age</span><span class="p">:</span>        <span class="mi">18</span><span class="p">,</span>
        <span class="nx">Hobbies</span><span class="p">:</span>    <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">&#34;coding&#34;</span><span class="p">,</span> <span class="s">&#34;math&#34;</span><span class="p">},</span>
    <span class="p">}</span>
    <span class="nx">data</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">json</span><span class="p">.</span><span class="nf">Marshal</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
    <span class="nx">w</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">mux</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/json&#34;</span><span class="p">,</span> <span class="nx">jsonHandler</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>通过<code>curl</code>发送请求：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">curl -i localhost:8080/json</pre></td></tr></table>
</div>
</div>
<p>返回：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></pre></td>
<td class="lntd">
<pre class="chroma">HTTP/1.1 200 OK
Content-Type: application/json
Date: Thu, 19 Dec 2019 14:31:03 GMT
Content-Length: 78

{&#34;first_name&#34;:&#34;lee&#34;,&#34;last_name&#34;:&#34;darjun&#34;,&#34;age&#34;:18,&#34;hobbies&#34;:[&#34;coding&#34;,&#34;math&#34;]}</pre></td></tr></table>
</div>
</div>
<p>可以看到响应首部中类型<code>Content-Type</code>被设置成了<code>application/json</code>。类似的格式还有 xml（<code>application/xml</code>）/pdf（<code>application/pdf</code>）/png（<code>image/png</code>）等等。</p>

<h2 id="cookie">cookie</h2>

<h3 id="概念">概念</h3>

<p>什么是 cookie？</p>

<p>cookie 的出现是为了解决 HTTP 协议的无状态性的。客户端通过 HTTP 协议与服务器通信，多次请求之间无法记录状态。服务器可以在响应中设置 cookie，客户端保存这些 cookie。然后每次请求时都带上这些 cookie，服务器就可以通过这些 cookie 记录状态，辨别用户身份等。</p>

<h3 id="重要性">重要性</h3>

<blockquote>
<p>整个计算机行业的收入都建立在 cookie 机制之上，广告领域更是如此。</p>
</blockquote>

<p>上面的说法虽然有些夸张，但是可见 cookie 的重要性。</p>

<p>我们知道广告是互联网最常见的盈利方式。其中有一个很厉害的广告模式，叫做<strong>联盟广告</strong>。你有没有这样一种经历，刚刚在百度上搜索了某个关键字，然后打开淘宝或京东后发现相关的商品已经被推荐到首页或边栏了。这是由于这些网站组成了广告联盟，只要加入它们，就可以共享用户浏览器的 cookie 数据。</p>

<h3 id="使用">使用</h3>

<p>Go 中 cookie 使用<code>http.Cookie</code>结构表示，在<code>net/http</code>包中定义：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="c1">// src/net/http/cookie.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Cookie</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">Name</span>        <span class="kt">string</span>
	<span class="nx">Value</span>       <span class="kt">string</span>
	<span class="nx">Path</span>        <span class="kt">string</span>
	<span class="nx">Domain</span>      <span class="kt">string</span>
	<span class="nx">Expires</span>     <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span>
	<span class="nx">RawExpires</span>  <span class="kt">string</span>
	<span class="nx">MaxAge</span>      <span class="kt">int</span>
	<span class="nx">Secure</span>      <span class="kt">bool</span>
	<span class="nx">HttpOnly</span>    <span class="kt">bool</span>
	<span class="nx">SameSite</span>    <span class="nx">SameSite</span>
	<span class="nx">Raw</span>         <span class="kt">string</span>
	<span class="nx">Unparsed</span>    <span class="p">[]</span><span class="kt">string</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>Name/Value</code>：cookie 的键值对，都是字符串类型；</li>
<li>没有设置<code>Expires</code>字段的 cookie 被称为<strong>会话 cookie</strong> 或<strong>临时 cookie</strong>，这种 cookie 在浏览器关闭时就会自动删除。设置了<code>Expires</code>字段的 cookie 称为<strong>持久 cookie</strong>，这种 cookie 会一直存在，直到指定的时间来临或手动删除；</li>
<li><code>HttpOnly</code>字段设置为<code>true</code>时，该 cookie 只能通过 HTTP 访问，不能使用其它方式操作，如 JavaScript。提高安全性；</li>
</ul>

<p>注意：</p>

<p><code>Expires</code>和<code>MaxAge</code>都可以用于设置 cookie 的过期时间。<code>Expires</code>字段设置的是 cookie 在什么<strong>时间点</strong>过期，而<code>MaxAge</code>字段表示 cookie 自创建之后能够存活多少秒。虽然 HTTP 1.1 中废弃了<code>Expires</code>，推荐使用<code>MaxAge</code>代替。但是几乎所有的浏览器都仍然支持<code>Expires</code>；而且，微软的 IE6/IE7/IE8 都不支持 <code>MaxAge</code>。所以为了更好的可移植性，可以只使用<code>Expires</code>或同时使用这两个字段。</p>

<p>cookie 需要通过响应的首部发送给客户端。浏览器收到<code>Set-Cookie</code>首部时，会将其中的值解析成 cookie 格式保存在浏览器中。下面我们来具体看看如何设置 cookie：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">setCookie</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c1</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span> <span class="p">{</span>
        <span class="nx">Name</span><span class="p">:</span>       <span class="s">&#34;name&#34;</span><span class="p">,</span>
        <span class="nx">Value</span><span class="p">:</span>      <span class="s">&#34;darjun&#34;</span><span class="p">,</span>
        <span class="nx">HttpOnly</span><span class="p">:</span>   <span class="kc">true</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="nx">c2</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span> <span class="p">{</span>
        <span class="nx">Name</span><span class="p">:</span>       <span class="s">&#34;age&#34;</span><span class="p">,</span>
        <span class="nx">Value</span><span class="p">:</span>      <span class="mi">18</span><span class="p">,</span>
        <span class="nx">HttpOnly</span><span class="p">:</span>   <span class="kc">true</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="nx">w</span><span class="p">.</span><span class="nf">Header</span><span class="p">().</span><span class="nf">Set</span><span class="p">(</span><span class="s">&#34;Set-Cookie&#34;</span><span class="p">,</span> <span class="nx">c1</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
    <span class="nx">w</span><span class="p">.</span><span class="nf">Header</span><span class="p">().</span><span class="nf">Add</span><span class="p">(</span><span class="s">&#34;Set-Cookie&#34;</span><span class="p">,</span> <span class="nx">c2</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span>
<span class="p">}</span>

<span class="nx">mux</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/set_cookie&#34;</span><span class="p">,</span> <span class="nx">setCookie</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>运行程序，打开浏览器输入<code>localhost:8080/set_cookie</code>，浏览器中什么都没有显示，我们需要通过开发者工具查看 cookie。在 chrome 浏览器（其它浏览器类似）按下 F12，切换到 Application（应用）标签，在左侧 Cookies 下点击测试的 URL，右侧即可显示我们刚刚设置的 cookie：</p>

<p><img src="/img/in-post/goweb/cookie1.png" alt="" /></p>

<p>当然，我们也可以使用<code>curl</code>测试。但是<code>curl</code>返回的结果就只是响应中的<code>Set-Cookie</code>首部：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span></pre></td>
<td class="lntd">
<pre class="chroma">curl -i localhost:8080/set_cookie</pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></pre></td>
<td class="lntd">
<pre class="chroma">HTTP/1.1 200 OK
Set-Cookie: name=darjun; HttpOnly
Set-Cookie: age=18; HttpOnly
Date: Fri, 20 Dec 2019 14:08:01 GMT
Content-Length: 0</pre></td></tr></table>
</div>
</div>
<p>上面构造 cookie 的代码中，有几点需要注意：</p>

<ul>
<li>首部名称为<code>Set-Cookie</code>；</li>
<li>首部的值需要是字符串，所以调用了<code>Cookie</code>类型的<code>String</code>方法将其转为字符串再设置；</li>
<li>设置第一个 cookie 调用<code>Header</code>类型的<code>Set</code>方法，添加第二个 cookie 时调用<code>Add</code>方法。<code>Set</code>会将同名的键覆盖掉。如果第二个也调用<code>Set</code>方法，那么第一个 cookie 将会被覆盖。</li>
</ul>

<p>为了使用的便捷，<code>net/http</code>包还提供了<code>SetCookie</code>方法。用法如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">setCookie2</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c1</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span> <span class="p">{</span>
        <span class="nx">Name</span><span class="p">:</span>       <span class="s">&#34;name&#34;</span><span class="p">,</span>
        <span class="nx">Value</span><span class="p">:</span>      <span class="s">&#34;darjun&#34;</span><span class="p">,</span>
        <span class="nx">HttpOnly</span><span class="p">:</span>   <span class="kc">true</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="nx">c2</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span> <span class="p">{</span>
        <span class="nx">Name</span><span class="p">:</span>       <span class="s">&#34;age&#34;</span><span class="p">,</span>
        <span class="nx">Value</span><span class="p">:</span>      <span class="s">&#34;18&#34;</span><span class="p">,</span>
        <span class="nx">HttpOnly</span><span class="p">:</span>   <span class="kc">true</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="nx">http</span><span class="p">.</span><span class="nf">SetCookie</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">c1</span><span class="p">)</span>
    <span class="nx">http</span><span class="p">.</span><span class="nf">SetCookie</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">c2</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">mux</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/set_cookie2&#34;</span><span class="p">,</span> <span class="nx">setCookie2</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>如果收到的响应中有 cookie 信息，浏览器会将这些 cookie 保存下来。只有没有过期，在向同一个主机发送请求时都会带上这些 cookie。在服务端，我们可以从请求的<code>Header</code>字段读取<code>Cookie</code>属性来获得 cookie：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">getCookie</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;Host:&#34;</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">Host</span><span class="p">)</span>
	<span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;Cookies:&#34;</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">Header</span><span class="p">[</span><span class="s">&#34;Cookie&#34;</span><span class="p">])</span>
<span class="p">}</span>

<span class="nx">mux</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/get_cookie&#34;</span><span class="p">,</span> <span class="nx">getCookie</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>第一次启动服务器，请求<code>localhost:8080/get_cookie</code>时，结果如下，没有 cookie 信息：</p>

<p><img src="/img/in-post/goweb/cookie2.png#center" alt="" /></p>

<p>先请求一次<code>localhost:8080/set_cookie</code>，然后再次请求<code>localhost:8080/get_cookie</code>，结果如下，浏览器将 cookie 传过来了：</p>

<p><img src="/img/in-post/goweb/cookie3.png#center" alt="" /></p>

<p><code>r.Header[&quot;Cookie&quot;]</code>返回一个切片，这个切片又包含了一个字符串，而这个字符串又包含了客户端发送的任意多个 cookie。如果想要取得单个键值对格式的 cookie，就需要解析这个字符串。
为此，<code>net/http</code>包在<code>http.Request</code>上提供了一些方法使我们更容易地获取 cookie：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">getCookie2</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">name</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nf">Cookie</span><span class="p">(</span><span class="s">&#34;name&#34;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;cannot get cookie of name&#34;</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="nx">cookies</span> <span class="o">:=</span> <span class="nx">r</span><span class="p">.</span><span class="nf">Cookies</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">c1</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Fprintln</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">cookies</span><span class="p">)</span>
<span class="p">}</span>

<span class="nx">mux</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/get_cookies&#34;</span><span class="p">,</span> <span class="nx">getCookies2</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><code>Cookie</code>方法返回以传入参数为键的 cookie，如果该 cookie 不存在，则返回一个错误；</li>
<li><code>Cookies</code>方法返回客户端传过来的所有 cookie。</li>
</ul>

<p>测试新的 URL <code>get_cookie2</code>：</p>

<p><img src="/img/in-post/goweb/cookie5.png#center" alt="" /></p>

<p>有一点需要注意，cookie 是与主机名绑定的，不考虑端口。我们上面查看 cookie 的图中有一列<code>Domain</code>表示的就是主机名。可以这样来验证一下，创建两个服务器，一个绑定在 8080 端口，一个绑定在 8081 端口，先请求<code>localhost:8080/set_cookie</code>设置 cookie，然后请求<code>localhost:8081/get_cookie</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-golang" data-lang="golang"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">mux1</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">NewServeMux</span><span class="p">()</span>
	<span class="nx">mux1</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/set_cookie&#34;</span><span class="p">,</span> <span class="nx">setCookie</span><span class="p">)</span>
	<span class="nx">mux1</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/get_cookie&#34;</span><span class="p">,</span> <span class="nx">getCookie</span><span class="p">)</span>

	<span class="nx">server1</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Server</span><span class="p">{</span>
		<span class="nx">Addr</span><span class="p">:</span>    <span class="s">&#34;:8080&#34;</span><span class="p">,</span>
		<span class="nx">Handler</span><span class="p">:</span> <span class="nx">mux1</span><span class="p">,</span>
	<span class="p">}</span>

	<span class="nx">mux2</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">NewServeMux</span><span class="p">()</span>
	<span class="nx">mux2</span><span class="p">.</span><span class="nf">HandleFunc</span><span class="p">(</span><span class="s">&#34;/get_cookie&#34;</span><span class="p">,</span> <span class="nx">getCookie</span><span class="p">)</span>

	<span class="nx">server2</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Server</span> <span class="p">{</span>
		<span class="nx">Addr</span><span class="p">:</span> 	 <span class="s">&#34;:8081&#34;</span><span class="p">,</span>
		<span class="nx">Handler</span><span class="p">:</span> <span class="nx">mux2</span><span class="p">,</span>
	<span class="p">}</span>
	
	<span class="nx">wg</span> <span class="o">:=</span> <span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">{}</span>
	<span class="nx">wg</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

	<span class="k">go</span> <span class="kd">func</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">defer</span> <span class="nx">wg</span><span class="p">.</span><span class="nf">Done</span><span class="p">()</span>

		<span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">server1</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">();</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="nx">log</span><span class="p">.</span><span class="nf">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
		<span class="p">}</span>
	<span class="p">}()</span>

	
	<span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">defer</span> <span class="nx">wg</span><span class="p">.</span><span class="nf">Done</span><span class="p">()</span>

		<span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">server2</span><span class="p">.</span><span class="nf">ListenAndServe</span><span class="p">();</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="nx">log</span><span class="p">.</span><span class="nf">Fatal</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
		<span class="p">}</span>
	<span class="p">}()</span>

	<span class="nx">wg</span><span class="p">.</span><span class="nf">Wait</span><span class="p">()</span>
<span class="p">}</span></code></pre></td></tr></table>
</div>
</div>
<p>发送给端口 8081 的请求同样可以获取 cookie：</p>

<p><img src="/img/in-post/goweb/cookie4.png#center" alt="" /></p>

<p>建议自己尝试一下，(<em>^_^</em>)</p>

<p>上面代码中，不能直接在主 goroutine 中依次<code>ListenAndServe</code>两个服务器。因为<code>ListenAndServe</code>只有在出错或关闭时才会返回。在此之前，第二个服务器永远得不到机会运行。所以，我创建两个 goroutine 各自运行一个服务器，并且使用<code>sync.WaitGroup</code>来同步。否则，主 goroutine 运行结束之后，整个程序就退出了。</p>

<h2 id="总结">总结</h2>

<p>本文介绍了如何响应客户端的请求和 cookie 的相关知识。相关代码在<a href="https://github.com/darjun/go-web-example/tree/master/4-response">Github</a>上，非常建议大家自己编写运行一遍以便加深印象。</p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">darjun</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2019-12-18
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          
        </div>

      
      <nav class="post-nav">
        
        
          <a class="next" href="/2019/12/09/goweb/request/">
            <span class="next-text nav-default">Go Web 编程之 请求</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "darjun/blog-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  <div class="disqus-comment">
  <div class="disqus-button" id="load_disqus" onclick="load_disqus()">
    显示 Disqus 评论
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = "https://darjun.github.io/2019/12/18/goweb/response/";
    };
    function load_disqus() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'https-maiyang-me';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

      $('#load_disqus').remove();
    };
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  
  </div>

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:leedarjun@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/darjun" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>


<a href="https://darjun.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2018 -
    2019
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        大俊
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.dee43230127a73d039a734510fa896c89c3c7ce0cf0be0c7a7433f8fd69b76dc.js" integrity="sha256-3uQyMBJ6c9A5pzRRD6iWyJw8fODPC&#43;DHp0M/j9abdtw=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>












</body>
</html>
